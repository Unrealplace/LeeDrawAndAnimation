
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
     
    <html xmlns="http://www.w3.org/1999/xhtml">
    
<head>  

    <script type="text/javascript" src="http://c.csdnimg.cn/pubfooter/js/tracking.js" charset="utf-8"></script>  

    <script type="text/javascript">
        var protocol = window.location.protocol;
        document.write('<script type="text/javascript" src="' + protocol + '//csdnimg.cn/pubfooter/js/repoAddr2.js?v=' + Math.random() + '"></' + 'script>');
    </script>

  
 <meta http-equiv="Cache-Control" content="no-siteapp" /><link rel="alternate" media="handheld" href="#" />

    <title>IOS绘图详解 - 侯文富的专栏
        - 博客频道 - CSDN.NET</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="description" content="这里演示了加密文本，利用特定字符来定位位置sockdata=PHIDOHBBNIEFMNDIBJLENNEBBODILAEAPMIHHKMKBOKILJOJHGPDDBEOPMCEMLAPJNFDLOJCPHEAMEDNPINODFMBMLFPFHLLGBNPPHEEMNFMNMCGNFEJFKIDOGBECBFJEBICBBLPMNHJAHJPCLNHKKEJMBLLNKFFKMPJJH" />
    <script src="http://static.blog.csdn.net/scripts/jquery.js" type="text/javascript"></script>
      <script type="text/javascript" src="http://static.blog.csdn.net/scripts/jquery-version.js"></script>
    <script type="text/javascript" src="http://static.blog.csdn.net/scripts/ad.js?v=1.1"></script>
        <!--new top-->
               <link rel="stylesheet" href="http://c.csdnimg.cn/public/common/toolbar/css/index.css">        <!--new top-->
    
      <!-- ad begin -->
         <script language="javascript" type="text/javascript" src="http://ads.csdn.net/js/tracking.js"></script>
    <!-- ad end-->

    <link rel="Stylesheet" type="text/css" href="http://static.blog.csdn.net/skin/dark1/css/style.css?v=1.1" />
    <link id="RSSLink" title="RSS" type="application/rss+xml" rel="alternate" href="/u012858744/rss/list" />
    <link rel="shortcut icon" href="http://c.csdnimg.cn/public/favicon.ico" />
    <link type="text/css" rel="stylesheet" href="http://static.blog.csdn.net/scripts/SyntaxHighlighter/styles/default_big.css" />
 


<script>
    var _hmt = _hmt || [];
    (function () {
        var hm = document.createElement("script");
        hm.src = "//hm.baidu.com/hm.js?6bcd52f51e9b3dce32bec4a3997715ac";
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(hm, s);
    })();
</script>

</head>
<body>


    <!-- 广告位开始 -->
        <ins data-revive-zoneid="149" data-revive-id="8c38e720de1c90a6f6ff52f3f89c4d57"></ins>
    <!-- 广告位结束 -->

    
   
      <!--new top-->
    <script id="toolbar-tpl-scriptId" fixed="true" prod="blog" skin="black" src="http://c.csdnimg.cn/public/common/toolbar/js/html.js" type="text/javascript"></script>
     <!--new top-->
    <div id="container">
        <div id="header">
    <div class="header">
        <div id="blog_title">
            <h2>
                <a href="http://blog.csdn.net/houwenfu">侯文富的专栏</a></h2>
            <h3>老师说:  今天你遇到的困难   是你明天吹牛逼的资本</h3>
            <div class="clear">
            </div>
        </div>
        <div class="clear">
        </div>
        
     
    </div>
</div>
<div id="navigator">
    <div class="navigator_bg">
    </div>
    <div class="navigator">
        <ul>           
                <li id="btnContents"><a href="http://blog.csdn.net/houwenfu?viewmode=contents"><span onclick="_gaq.push(['_trackEvent','function', 'onclick', 'blog_articles_mulu'])">
                    <img src="http://static.blog.csdn.net/images/ico_list.gif">目录视图</span></a></li>
                <li id="btnView"><a href="http://blog.csdn.net/houwenfu?viewmode=list"><span onclick="_gaq.push(['_trackEvent','function', 'onclick', 'blog_articles_zhaiyao'])">
                    <img src="http://static.blog.csdn.net/images/ico_summary.gif">摘要视图</span></a></li>
                <li id="btnRss"><a href="http://blog.csdn.net/houwenfu/rss/list"><span onclick="_gaq.push(['_trackEvent','function', 'onclick', 'blog_articles_RSS'])">
                    <img src="http://static.blog.csdn.net/images/ico_rss.gif">订阅</span></a></li>                
            

            </ul>
    </div>
</div>
<script type="text/javascript">
    var username = "u012858744";
    var _blogger = username;
    var blog_address = "http://blog.csdn.net/houwenfu";
    var static_host = "http://static.blog.csdn.net";
    var currentUserName = "";  
</script>

        <div id="body">
            <div id="main">
                <div class="main">
                        <div class="ad_class">
<div class="notice tracking-ad" data-mod='popu_3' > 


<a href="http://blog.csdn.net/vote/result.html
">
<font color=blue>CSDN 2016博客之星评选结果公布


</font></a>

&nbsp;&nbsp;&nbsp;&nbsp

<a href="http://edu.csdn.net/huiyiCourse/detail/263
">
<font color=red>【系列直播】零基础学习微信小程序！ 
</font></a>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<a href="http://blog.csdn.net/turingbooks/article/details/53606998">
<font color=blue>程序员12月书讯
</font></a>

&nbsp;&nbsp;&nbsp;

<a href="http://blog.csdn.net/baiyuzhong2012/article/details/54098338">
<font color=red>博客的神秘功能
</font></a>


</div>                        </div>
                        



  
<link href="http://static.blog.csdn.net/css/comment1.css" type="text/css" rel="stylesheet" />
<link href="http://static.blog.csdn.net/css/style1.css" type="text/css" rel="stylesheet" />
<script language='JavaScript' type='text/javascript' src='http://download.csdn.net/js/jquery.cookie.js'></script>
<script type="text/javascript" src="http://c.csdnimg.cn/rabbit/search-service/main.js"></script>
<link rel="stylesheet" href="http://static.blog.csdn.net/public/res-min/markdown_views.css?v=1.0" />
<link rel="stylesheet" href="http://static.blog.csdn.net/css/category.css?v=1.0" />
<script type="text/javascript" src="http://static.blog.csdn.net/public/res/bower-libs/MathJax/MathJax.js?config=TeX-AMS_HTML"></script>
<script type="text/javascript" src="http://static.blog.csdn.net/scripts/web-storage-cache.min.js"></script>
<script type="text/javascript" src="http://static.blog.csdn.net/scripts/replace.min.js"></script>




  <script type="text/ecmascript">
      window.quickReplyflag = true;
           
            var isBole = false;
            
      
      var fasrc="http://my.csdn.net/my/favorite/miniadd?t=IOS%e7%bb%98%e5%9b%be%e8%af%a6%e8%a7%a3&u=http://blog.csdn.net/houwenfu/article/details/19172947"

    </script>
<div id="article_details" class="details">
    <div class="article_title">   
         <span class="ico ico_type_Original"></span>


    <h1>
        <span class="link_title"><a href="/houwenfu/article/details/19172947">
        IOS绘图详解            
        </a></span>
    </h1>
</div>

   

        <div class="article_manage clearfix">
        <div class="article_l">
            <span class="link_categories">
            标签：
              <a href='http://www.csdn.net/tag/ios' target=_blank onclick="_gaq.push(['_trackEvent','function', 'onclick', 'blog_articles_tag']);">ios</a><a href='http://www.csdn.net/tag/iphone' target=_blank onclick="_gaq.push(['_trackEvent','function', 'onclick', 'blog_articles_tag']);">iphone</a><a href='http://www.csdn.net/tag/%e7%bb%98%e5%9b%be' target=_blank onclick="_gaq.push(['_trackEvent','function', 'onclick', 'blog_articles_tag']);">绘图</a>
            </span>
        </div>
        <div class="article_r">
            <span class="link_postdate">2014-02-13 20:55</span>
            <span class="link_view" title="阅读次数">1005人阅读</span>
            <span class="link_comments" title="评论次数"> <a href="#comments" onclick="_gaq.push(['_trackEvent','function', 'onclick', 'blog_articles_pinglun'])">评论</a>(0)</span>
            <span class="link_collect tracking-ad" data-mod="popu_171"> <a href="javascript:void(0);" onclick="javascript:collectArticle('IOS%e7%bb%98%e5%9b%be%e8%af%a6%e8%a7%a3','19172947');return false;" title="收藏">收藏</a></span>
             <span class="link_report"> <a href="#report" onclick="javascript:report(19172947,2);return false;" title="举报">举报</a></span>

        </div>
    </div>
    <div class="embody"  style="display:none" id="embody">
        <span class="embody_t">本文章已收录于：</span>
        <div class="embody_c" id="lib" value="{&quot;err&quot;:0,&quot;msg&quot;:&quot;ok&quot;,&quot;data&quot;:[]}"></div>
    </div>
    <style type="text/css">        
            .embody{
                padding:10px 10px 10px;
                margin:0 -20px;
                border-bottom:solid 1px #ededed;                
            }
            .embody_b{
                margin:0 ;
                padding:10px 0;
            }
            .embody .embody_t,.embody .embody_c{
                display: inline-block;
                margin-right:10px;
            }
            .embody_t{
                font-size: 12px;
                color:#999;
            }
            .embody_c{
                font-size: 12px;
            }
            .embody_c img,.embody_c em{
                display: inline-block;
                vertical-align: middle;               
            }
             .embody_c img{               
                width:30px;
                height:30px;
            }
            .embody_c em{
                margin: 0 20px 0 10px;
                color:#333;
                font-style: normal;
            }
    </style>
    <script  type="text/javascript">
        $(function () {
            try
            {
                var lib = eval("("+$("#lib").attr("value")+")");
                var html = "";
                if (lib.err == 0) {
                    $.each(lib.data, function (i) {
                        var obj = lib.data[i];
                        //html += '<img src="' + obj.logo + '"/>' + obj.name + "&nbsp;&nbsp;";
                        html += ' <a href="' + obj.url + '" target="_blank">';
                        html += ' <img src="' + obj.logo + '">';
                        html += ' <em><b>' + obj.name + '</b></em>';
                        html += ' </a>';
                    });
                    if (html != "") {
                        setTimeout(function () {
                            $("#lib").html(html);                      
                            $("#embody").show();
                        }, 100);
                    }
                }      
            } catch (err)
            { }
            
        });
    </script>
      <div class="category clearfix">
        <div class="category_l">
           <img src="http://static.blog.csdn.net/images/category_icon.jpg">
            <span>分类：</span>
        </div>
        <div class="category_r">
                    <label  onclick="GetCategoryArticles('1790805','u012858744','top','19172947');">
                        <span onclick="_gaq.push(['_trackEvent','function', 'onclick', 'blog_articles_fenlei']);">IOS开发<em>（61）</em></span>
                      <img class="arrow-down" src="http://static.blog.csdn.net/images/arrow_triangle _down.jpg" style="display:inline;">
                      <img class="arrow-up" src="http://static.blog.csdn.net/images/arrow_triangle_up.jpg" style="display:none;">
                        <div class="subItem">
                            <div class="subItem_t"><a  href="http://blog.csdn.net/u012858744/article/category/1790805"  target="_blank">作者同类文章</a><i class="J_close">X</i></div>
                            <ul class="subItem_l" id="top_1790805">                            
                            </ul>
                        </div>
                    </label>                    
        </div>
    </div>
    <script   type="text/javascript" src="http://static.blog.csdn.net/scripts/category.js"></script>  
        <div   class="bog_copyright">         
            <p  class="copyright_p" >版权声明：本文为博主原创文章，未经博主允许不得转载。</p>
        </div>

  

  
  
     

<div id="article_content" class="article_content">

<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
Core Graphics Framework是一套基于C的API框架，使用了Quartz作为绘图引擎。它提供了低级别、轻量级、高保真度的2D渲染。该框架可以用于基于路径的绘图、变换、颜色管理、脱屏渲染，模板、渐变、遮蔽、图像数据管理、图像的创建、遮罩以及PDF文档的创建、显示和分析。为了从感官上对这些概念做一个入门的认识，你可以运行一下官方的<a target="_blank" href="https://developer.apple.com/library/ios/samplecode/QuartzDemo/Introduction/Intro.html#//apple_ref/doc/uid/DTS40007531" target="_blank" style="font-size:12px; line-height:normal; text-decoration:none; color:rgb(102,102,102)"><span style="color:rgb(0,0,255)">example
 code</span></a>。</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
iOS支持两套图形API族：Core Graphics/QuartZ 2D 和OpenGL ES。OpenGL ES是跨平台的图形API，属于OpenGL的一个简化版本。QuartZ 2D是苹果公司开发的一套API，它是Core Graphics Framework的一部分。需要注意的是：OpenGL ES是应用程序编程接口，该接口描述了方法、结构、函数应具有的行为以及应该如何被使用的语义。也就是说它只定义了一套规范，具体的实现由设备制造商根据规范去做。而往往很多人对接口和实现存在误解。举一个不恰当的比喻：上发条的时钟和装电池的时钟都有相同的可视行为，但两者的内部实现截然不同。因为制造商可以自由的实现Open
 GL ES，所以不同系统实现的OpenGL ES也存在着巨大的性能差异。</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
Core Graphics API所有的操作都在一个上下文中进行。所以在绘图之前需要获取该上下文并传入执行渲染的函数中。如果你正在渲染一副在内存中的图片，此时就需要传入图片所属的上下文。获得一个图形上下文是我们完成绘图任务的第一步，你可以将图形上下文理解为一块画布。如果你没有得到这块画布，那么你就无法完成任何绘图操作。当然，有许多方式获得一个图形上下文，这里我介绍两种最为常用的获取方法。</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
第一种方法就是创建一个图片类型的上下文。调用UIGraphicsBeginImageContextWithOptions函数就可获得用来处理图片的图形上下文。利用该上下文，你就可以在其上进行绘图，并生成图片。调用UIGraphicsGetImageFromCurrentImageContext函数可从当前上下文中获取一个UIImage对象。记住在你所有的绘图操作后别忘了调用UIGraphicsEndImageContext函数关闭图形上下文。</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
第二种方法是利用cocoa为你生成的图形上下文。当你子类化了一个UIView并实现了自己的drawRect：方法后，一旦drawRect：方法被调用，Cocoa就会为你创建一个图形上下文，此时你对图形上下文的所有绘图操作都会显示在UIView上。</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
判断一个上下文是否为当前图形上下文需要注意的几点：</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
1.UIGraphicsBeginImageContextWithOptions函数不仅仅是创建了一个适用于图形操作的上下文，并且该上下文也属于当前上下文。</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
2.当drawRect方法被调用时，UIView的绘图上下文属于当前图形上下文。</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
3.回调方法所持有的context：参数并不会让任何上下文成为当前图形上下文。此参数仅仅是对一个图形上下文的引用罢了。</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
<strong>作为初学者，很容易被UIKit和Core Graphics两个支持绘图的框架迷惑。</strong></div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
<span style="color:rgb(51,153,102)"><strong>UIKit</strong></span></div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
像UIImage、NSString（绘制文本）、UIBezierPath（绘制形状）、UIColor都知道如何绘制自己。这些类提供了功能有限但使用方便的方法来让我们完成绘图任务。一般情况下，UIKit就是我们所需要的。</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
使用UiKit，<span style="color:rgb(255,0,0)">你只能在当前上下文中绘图</span>，所以如果你当前处于UIGraphicsBeginImageContextWithOptions函数或drawRect：方法中，你就可以直接使用UIKit提供的方法进行绘图。如果你持有一个context：参数，那么使用UIKit提供的方法之前，必须将该上下文参数转化为当前上下文。幸运的是，调用UIGraphicsPushContext 函数可以方便的将context：参数转化为当前上下文，记住最后别忘了调用UIGraphicsPopContext函数恢复上下文环境。</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
<span style="color:rgb(51,153,102)"><strong>Core Graphics</strong></span></div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
这是一个绘图专用的API族，它经常被称为QuartZ或QuartZ 2D。Core Graphics是iOS上所有绘图功能的基石，包括UIKit。</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
使用Core Graphics之前需要指定一个用于绘图的图形上下文（CGContextRef），这个图形上下文会在每个绘图函数中都会被用到。如果你持有一个图形上下文context：参数，那么你等同于有了一个图形上下文，这个上下文也许就是你需要用来绘图的那个。如果你当前处于UIGraphicsBeginImageContextWithOptions函数或drawRect：方法中，并没有引用一个上下文。为了使用Core Graphics，你可以调用UIGraphicsGetCurrentContext函数获得当前的图形上下文。</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
至此，我们有了两大绘图框架的支持以及三种获得图形上下文的方法（drawRect:、drawRect: inContext:、UIGraphicsBeginImageContextWithOptions）。那么我们就有6种绘图的形式。如果你有些困惑了，不用怕，我接下来将说明这6种情况。无需担心还没有具体的绘图命令，你只需关注上下文如何被创建以及我们是在使用UIKit还是Core Graphics。</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
<strong>第一种绘图形式：</strong>在UIView的子类方法drawRect：中绘制一个蓝色圆，使用UIKit在Cocoa为我们提供的当前上下文中完成绘图任务。</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<pre style="margin-top:0px; margin-bottom:1em; padding:0px; font-family:'Courier New',monospace; width:662.296875px; overflow:auto; background-color:rgb(247,247,247); color:rgb(51,51,51)"><ol class="dp-c" style="padding:5px 0px; list-style-position:initial; border-style:none none none solid; border-left-width:3px; border-left-color:rgb(20,107,0); color:rgb(92,92,92); margin:0px 0px 1px 3em!important"><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit"><span style="margin:0px; padding:0px; border:none; background-color:inherit">-&nbsp;(</span><span class="keyword" style="margin:0px; padding:0px; border:none; color:rgb(0,102,153); background-color:inherit; font-weight:bold">void</span><span style="margin:0px; padding:0px; border:none; background-color:inherit">)&nbsp;drawRect:&nbsp;(CGRect)&nbsp;rect&nbsp;{&nbsp;</span></span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">UIBezierPath*&nbsp;p&nbsp;=&nbsp;[UIBezierPathbezierPathWithOvalInRect:CGRectMake(0,0,100,100)];&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">[[UIColor&nbsp;blueColor]&nbsp;setFill];&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">[p&nbsp;fill];&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">}&nbsp;</span></li></ol></pre>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
<strong>第二种绘图形式：</strong>使用Core Graphics实现绘制蓝色圆。</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<pre style="margin-top:0px; margin-bottom:1em; padding:0px; font-family:'Courier New',monospace; width:662.296875px; overflow:auto; background-color:rgb(247,247,247); color:rgb(51,51,51)"><ol class="dp-c" style="padding:5px 0px; list-style-position:initial; border-style:none none none solid; border-left-width:3px; border-left-color:rgb(20,107,0); color:rgb(92,92,92); margin:0px 0px 1px 3em!important"><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit"><span style="margin:0px; padding:0px; border:none; background-color:inherit">-&nbsp;(</span><span class="keyword" style="margin:0px; padding:0px; border:none; color:rgb(0,102,153); background-color:inherit; font-weight:bold">void</span><span style="margin:0px; padding:0px; border:none; background-color:inherit">)&nbsp;drawRect:&nbsp;(CGRect)&nbsp;rect&nbsp;{&nbsp;</span></span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGContextRef&nbsp;con&nbsp;=&nbsp;UIGraphicsGetCurrentContext();&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGContextAddEllipseInRect(con,&nbsp;CGRectMake(0,0,100,100));&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGContextSetFillColorWithColor(con,&nbsp;[UIColor&nbsp;blueColor].CGColor);&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGContextFillPath(con);&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">}&nbsp;</span></li></ol></pre>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
<strong>第三种绘图形式：</strong>我将在UIView子类的drawLayer:inContext：方法中实现绘图任务。drawLayer:inContext：方法是一个绘制图层内容的代理方法。为了能够调用drawLayer:inContext：方法，我们需要设定图层的代理对象。但要注意，不应该将UIView对象设置为显示层的委托对象，这是因为UIView对象已经是隐式层的代理对象，再将它设置为另一个层的委托对象就会出问题。轻量级的做法是：编写负责绘图形的代理类。在MyView.h文件中声明如下代码：</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<pre style="margin-top:0px; margin-bottom:1em; padding:0px; font-family:'Courier New',monospace; width:662.296875px; overflow:auto; background-color:rgb(247,247,247); color:rgb(51,51,51)"><ol class="dp-c" style="padding:5px 0px; list-style-position:initial; border-style:none none none solid; border-left-width:3px; border-left-color:rgb(20,107,0); color:rgb(92,92,92); margin:0px 0px 1px 3em!important"><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit"><span style="margin:0px; padding:0px; border:none; background-color:inherit">@</span><span class="keyword" style="margin:0px; padding:0px; border:none; color:rgb(0,102,153); background-color:inherit; font-weight:bold">interface</span><span style="margin:0px; padding:0px; border:none; background-color:inherit">&nbsp;MyLayerDelegate&nbsp;:&nbsp;NSObject&nbsp;</span></span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">@end&nbsp;</span></li></ol></pre>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
然后MyView.m文件中实现接口代码：</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<pre style="margin-top:0px; margin-bottom:1em; padding:0px; font-family:'Courier New',monospace; width:662.296875px; overflow:auto; background-color:rgb(247,247,247); color:rgb(51,51,51)"><ol class="dp-c" style="padding:5px 0px; list-style-position:initial; border-style:none none none solid; border-left-width:3px; border-left-color:rgb(20,107,0); color:rgb(92,92,92); margin:0px 0px 1px 3em!important"><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">@implementation&nbsp;MyLayerDelegate&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">-&nbsp;(<span class="keyword" style="margin:0px; padding:0px; border:none; color:rgb(0,102,153); background-color:inherit; font-weight:bold">void</span><span style="margin:0px; padding:0px; border:none; background-color:inherit">)drawLayer:(CALayer*)layer&nbsp;inContext:(CGContextRef)ctx&nbsp;{&nbsp;</span></span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;&nbsp;UIGraphicsPushContext(ctx);&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;&nbsp;UIBezierPath*&nbsp;p&nbsp;=&nbsp;[UIBezierPath&nbsp;bezierPathWithOvalInRect:CGRectMake(0,0,100,100)];&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;&nbsp;[[UIColor&nbsp;blueColor]&nbsp;setFill];&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;&nbsp;[p&nbsp;fill];&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;&nbsp;UIGraphicsPopContext();&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">}&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">@end&nbsp;</span></li></ol></pre>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
直接将代理类的实现代码放在MyView.m文件的#import代码的下面，这样感觉好像在使用私有类完成绘图任务（虽然这不是私有类）。需要注意的是，我们所引用的上下文并不是当前上下文，所以为了能够使用UIKit，我们需要将引用的上下文转变成当前上下文。</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
因为图层的代理是assign内存管理策略，那么这里就不能以局部变量的形式创建MyLayerDelegate实例对象赋&#20540;给图层代理。这里选择在MyView.m中增加一个实例变量，因为实例变量默认是strong:</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<pre style="margin-top:0px; margin-bottom:1em; padding:0px; font-family:'Courier New',monospace; width:662.296875px; overflow:auto; background-color:rgb(247,247,247); color:rgb(51,51,51)"><ol class="dp-c" style="padding:5px 0px; list-style-position:initial; border-style:none none none solid; border-left-width:3px; border-left-color:rgb(20,107,0); color:rgb(92,92,92); margin:0px 0px 1px 3em!important"><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit"><span style="margin:0px; padding:0px; border:none; background-color:inherit">@</span><span class="keyword" style="margin:0px; padding:0px; border:none; color:rgb(0,102,153); background-color:inherit; font-weight:bold">interface</span><span style="margin:0px; padding:0px; border:none; background-color:inherit">&nbsp;MyView&nbsp;()&nbsp;{&nbsp;</span></span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">MyLayerDelegate*&nbsp;_layerDeleagete;&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">}&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">@end&nbsp;</span></li></ol></pre>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
使用该图层代理：</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<pre style="margin-top:0px; margin-bottom:1em; padding:0px; font-family:'Courier New',monospace; width:662.296875px; overflow:auto; background-color:rgb(247,247,247); color:rgb(51,51,51)"><ol class="dp-c" style="padding:5px 0px; list-style-position:initial; border-style:none none none solid; border-left-width:3px; border-left-color:rgb(20,107,0); color:rgb(92,92,92); margin:0px 0px 1px 3em!important"><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">MyView&nbsp;*myView&nbsp;=&nbsp;[[MyView&nbsp;alloc]&nbsp;initWithFrame:&nbsp;CGRectMake(0,&nbsp;0,&nbsp;320,&nbsp;480)];&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CALayer&nbsp;*myLayer&nbsp;=&nbsp;[CALayer&nbsp;layer];&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">_layerDelegate&nbsp;=&nbsp;[[MyLayerDelegate&nbsp;alloc]&nbsp;init];&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">myLayer.delegate&nbsp;=&nbsp;_layerDelegate;&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">[myView.layer&nbsp;addSublayer:myLayer];&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">[myView&nbsp;setNeedsDisplay];&nbsp;<span class="comment" style="margin:0px; padding:0px; border:none; color:rgb(0,130,0); background-color:inherit">//&nbsp;调用此方法，drawLayer:&nbsp;inContext:方法才会被调用。</span><span style="margin:0px; padding:0px; border:none; background-color:inherit">&nbsp;</span></span></li></ol></pre>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
<strong>第四种绘图形式：</strong>&nbsp;使用Core Graphics在drawLayer:inContext：方法中实现同样操作，代码如下：</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<pre style="margin-top:0px; margin-bottom:1em; padding:0px; font-family:'Courier New',monospace; width:662.296875px; overflow:auto; background-color:rgb(247,247,247); color:rgb(51,51,51)"><ol class="dp-c" style="padding:5px 0px; list-style-position:initial; border-style:none none none solid; border-left-width:3px; border-left-color:rgb(20,107,0); color:rgb(92,92,92); margin:0px 0px 1px 3em!important"><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit"><span style="margin:0px; padding:0px; border:none; background-color:inherit">-&nbsp;(</span><span class="keyword" style="margin:0px; padding:0px; border:none; color:rgb(0,102,153); background-color:inherit; font-weight:bold">void</span><span style="margin:0px; padding:0px; border:none; background-color:inherit">)drawLayer:(CALayer*)lay&nbsp;inContext:(CGContextRef)con&nbsp;{&nbsp;</span></span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGContextAddEllipseInRect(con,&nbsp;CGRectMake(0,0,100,100));&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGContextSetFillColorWithColor(con,&nbsp;[UIColor&nbsp;blueColor].CGColor);&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGContextFillPath(con);&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">}&nbsp;</span></li></ol></pre>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
最后，演示UIGraphicsBeginImageContextWithOptions的用法，并从上下文中生成一个UIImage对象。生成UIImage对象的代码并不需要等待某些方法被调用后或在UIView的子类中才能去做。</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
<strong>第五种绘图形式：</strong>&nbsp;使用UIKit实现：</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<pre style="margin-top:0px; margin-bottom:1em; padding:0px; font-family:'Courier New',monospace; width:662.296875px; overflow:auto; background-color:rgb(247,247,247); color:rgb(51,51,51)"><ol class="dp-c" style="padding:5px 0px; list-style-position:initial; border-style:none none none solid; border-left-width:3px; border-left-color:rgb(20,107,0); color:rgb(92,92,92); margin:0px 0px 1px 3em!important"><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">UIGraphicsBeginImageContextWithOptions(CGSizeMake(100,100),&nbsp;NO,&nbsp;0);&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">UIBezierPath*&nbsp;p&nbsp;=&nbsp;[UIBezierPath&nbsp;bezierPathWithOvalInRect:CGRectMake(0,0,100,100)];&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">[[UIColor&nbsp;blueColor]&nbsp;setFill];&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">[p&nbsp;fill];&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">UIImage*&nbsp;im&nbsp;=&nbsp;UIGraphicsGetImageFromCurrentImageContext();&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">UIGraphicsEndImageContext();&nbsp;</span></li></ol></pre>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
解释一下UIGraphicsBeginImageContextWithOptions函数参数的含义：第一个参数表示所要创建的图片的尺寸；第二个参数用来指定所生成图片的背景是否为不透明，如上我们使用YES而不是NO，则我们得到的图片背景将会是黑色，显然这不是我想要的；第三个参数指定生成图片的缩放因子，这个缩放因子与UIImage的scale属性所指的含义是一致的。传入0则表示让图片的缩放因子根据屏幕的分辨率而变化，所以我们得到的图片不管是在单分辨率还是视网膜屏上看起来都会很好。</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
<strong>第六种绘图形式：</strong>&nbsp;使用Core Graphics实现：</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<pre style="margin-top:0px; margin-bottom:1em; padding:0px; font-family:'Courier New',monospace; width:662.296875px; overflow:auto; background-color:rgb(247,247,247); color:rgb(51,51,51)"><ol class="dp-c" style="padding:5px 0px; list-style-position:initial; border-style:none none none solid; border-left-width:3px; border-left-color:rgb(20,107,0); color:rgb(92,92,92); margin:0px 0px 1px 3em!important"><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">UIGraphicsBeginImageContextWithOptions(CGSizeMake(100,100),&nbsp;NO,&nbsp;0);&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGContextRef&nbsp;con&nbsp;=&nbsp;UIGraphicsGetCurrentContext();&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGContextAddEllipseInRect(con,&nbsp;CGRectMake(0,0,100,100));&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGContextSetFillColorWithColor(con,&nbsp;[UIColor&nbsp;blueColor].CGColor);&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGContextFillPath(con);&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">UIImage*&nbsp;im&nbsp;=&nbsp;UIGraphicsGetImageFromCurrentImageContext();&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">UIGraphicsEndImageContext();&nbsp;</span></li></ol></pre>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;UIKit和Core Graphics可以在相同的图形上下文中混合使用。在iOS 4.0之前，使用UIKit和UIGraphicsGetCurrentContext被认为是线程不安全的。而在iOS4.0以后苹果让绘图操作在第二个线程中执行解决了此问题。</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
<strong>UIImage常用的绘图操作</strong></div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
一个UIImage对象提供了向当前上下文绘制自身的方法。我们现在已经知道如何获取一个图片类型的上下文并将它转变成当前上下文。</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
平移操作：下面的代码展示了如何将UIImage绘制在当前的上下文中。</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<pre style="margin-top:0px; margin-bottom:1em; padding:0px; font-family:'Courier New',monospace; width:662.296875px; overflow:auto; background-color:rgb(247,247,247); color:rgb(51,51,51)"><ol class="dp-c" style="padding:5px 0px; list-style-position:initial; border-style:none none none solid; border-left-width:3px; border-left-color:rgb(20,107,0); color:rgb(92,92,92); margin:0px 0px 1px 3em!important"><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit"><span style="margin:0px; padding:0px; border:none; background-color:inherit">UIImage*&nbsp;mars&nbsp;=&nbsp;[UIImage&nbsp;imageNamed:@</span><span class="string" style="margin:0px; padding:0px; border:none; color:blue; background-color:inherit">&quot;Mars.png&quot;</span><span style="margin:0px; padding:0px; border:none; background-color:inherit">];&nbsp;</span></span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGSize&nbsp;sz&nbsp;=&nbsp;[mars&nbsp;size];&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">UIGraphicsBeginImageContextWithOptions(CGSizeMake(sz.width*2,&nbsp;sz.height),&nbsp;NO,&nbsp;0);&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">[mars&nbsp;drawAtPoint:CGPointMake(0,0)];&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">[mars&nbsp;drawAtPoint:CGPointMake(sz.width,0)];&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">UIImage*&nbsp;im&nbsp;=&nbsp;UIGraphicsGetImageFromCurrentImageContext();&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">UIGraphicsEndImageContext();&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">UIImageView*&nbsp;iv&nbsp;=&nbsp;[[UIImageView&nbsp;alloc]&nbsp;initWithImage:im];&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">[self.window.rootViewController.view&nbsp;addSubview:&nbsp;iv];&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;&nbsp;&nbsp;&nbsp;iv.center&nbsp;=&nbsp;self.window.center;&nbsp;</span></li></ol>
</pre>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px; text-align:center">
<img src="http://www.cocoachina.com/cms/uploads/allimg/140115/4196_140115112545_1.png" width="482" border="0" height="103" alt="" style="border:0px; max-width:700px; margin:10px 0px"></div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px; text-align:center">
图1 UIImage平移处理</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
<strong>缩放操作：</strong>下面代码展示了如何对UIImage进行缩放操作：</div>
<pre style="margin-top:0px; margin-bottom:1em; padding:0px; font-family:'Courier New',monospace; width:662.296875px; overflow:auto; background-color:rgb(247,247,247); color:rgb(51,51,51)"><ol class="dp-c" style="padding:5px 0px; list-style-position:initial; border-style:none none none solid; border-left-width:3px; border-left-color:rgb(20,107,0); color:rgb(92,92,92); margin:0px 0px 1px 3em!important"><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit"><span style="margin:0px; padding:0px; border:none; background-color:inherit">UIImage*&nbsp;mars&nbsp;=&nbsp;[UIImage&nbsp;imageNamed:@</span><span class="string" style="margin:0px; padding:0px; border:none; color:blue; background-color:inherit">&quot;Mars.png&quot;</span><span style="margin:0px; padding:0px; border:none; background-color:inherit">];&nbsp;</span></span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGSize&nbsp;sz&nbsp;=&nbsp;[mars&nbsp;size];&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">UIGraphicsBeginImageContextWithOptions(CGSizeMake(sz.width*2,&nbsp;sz.height*2),&nbsp;NO,&nbsp;0);&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">[mars&nbsp;drawInRect:CGRectMake(0,0,sz.width*2,sz.height*2)];&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">[mars&nbsp;drawInRect:CGRectMake(sz.width/2.0,&nbsp;sz.height/2.0,&nbsp;sz.width,&nbsp;sz.height)&nbsp;blendMode:kCGBlendModeMultiply&nbsp;alpha:1.0];&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">UIImage*&nbsp;im&nbsp;=&nbsp;UIGraphicsGetImageFromCurrentImageContext();&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">UIGraphicsEndImageContext();&nbsp;</span></li></ol></pre>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px; text-align:center">
<img src="http://www.cocoachina.com/cms/uploads/allimg/140115/4196_140115112653_1.png" width="432" border="0" height="169" alt="" style="border:0px; max-width:700px; margin:10px 0px"></div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px; text-align:center">
图2 UIImage缩放处理</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
UIImage没有提供截取图片指定区域的功能。但通过创建一个较小的图形上下文并移动图片到一个适当的图形上下文坐标系内，指定区域内的图片就会被获取。</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
<strong>裁剪操作：</strong>下面代码展示了如何获取图片的右半边：</div>
<pre style="margin-top:0px; margin-bottom:1em; padding:0px; font-family:'Courier New',monospace; width:662.296875px; overflow:auto; background-color:rgb(247,247,247); color:rgb(51,51,51)"><ol class="dp-c" style="padding:5px 0px; list-style-position:initial; border-style:none none none solid; border-left-width:3px; border-left-color:rgb(20,107,0); color:rgb(92,92,92); margin:0px 0px 1px 3em!important"><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit"><span style="margin:0px; padding:0px; border:none; background-color:inherit">UIImage*&nbsp;mars&nbsp;=&nbsp;[UIImage&nbsp;imageNamed:@</span><span class="string" style="margin:0px; padding:0px; border:none; color:blue; background-color:inherit">&quot;Mars.png&quot;</span><span style="margin:0px; padding:0px; border:none; background-color:inherit">];&nbsp;</span></span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGSize&nbsp;sz&nbsp;=&nbsp;[mars&nbsp;size];&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">UIGraphicsBeginImageContextWithOptions(CGSizeMake(sz.width/2.0,&nbsp;sz.height),&nbsp;NO,&nbsp;0);&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">[mars&nbsp;drawAtPoint:CGPointMake(-sz.width/2.0,&nbsp;0)];&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">UIImage*&nbsp;im&nbsp;=&nbsp;UIGraphicsGetImageFromCurrentImageContext();&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">UIGraphicsEndImageContext();&nbsp;</span></li></ol></pre>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
以上的代码首先创建一个一半图片宽度的图形上下文，然后将图片左上角原点移动到与图形上下文负X坐标对齐，从而让图片只有右半部分与图形上下文相交。</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px; text-align:center">
<img src="http://www.cocoachina.com/cms/uploads/allimg/140115/4196_140115112740_1.png" width="330" border="0" height="229" alt="" style="border:0px; max-width:700px; margin:10px 0px"></div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px; text-align:center">
图3 UIImage裁剪原理</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
<strong>CGImage常用的绘图操作</strong></div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
UIImage的Core Graphics版本是CGImage（具体类型是CGImageRef）。两者可以直接相互转化: 使用UIImage的CGImage属性可以访问Quartz图片数据；将CGImage作为UIImage方法imageWithCGImage:或initWithCGImage:的参数创建UIImage对象。</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
一个CGImage对象可以让你获取原始图片中指定区域的图片（也可以获取指定区域外的图片，UIImage却办不到）。</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
下面的代码展示了将图片拆分成两半，并分别绘制在上下文的左右两边：</div>
<pre style="margin-top:0px; margin-bottom:1em; padding:0px; font-family:'Courier New',monospace; width:662.296875px; overflow:auto; background-color:rgb(247,247,247); color:rgb(51,51,51)"><ol class="dp-c" style="padding:5px 0px; list-style-position:initial; border-style:none none none solid; border-left-width:3px; border-left-color:rgb(20,107,0); color:rgb(92,92,92); margin:0px 0px 1px 3em!important"><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit"><span style="margin:0px; padding:0px; border:none; background-color:inherit">UIImage*&nbsp;mars&nbsp;=&nbsp;[UIImage&nbsp;imageNamed:@</span><span class="string" style="margin:0px; padding:0px; border:none; color:blue; background-color:inherit">&quot;Mars.png&quot;</span><span style="margin:0px; padding:0px; border:none; background-color:inherit">];&nbsp;</span></span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit"><span class="comment" style="margin:0px; padding:0px; border:none; color:rgb(0,130,0); background-color:inherit">//&nbsp;抽取图片的左右半边</span><span style="margin:0px; padding:0px; border:none; background-color:inherit">&nbsp;</span></span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGSize&nbsp;sz&nbsp;=&nbsp;[mars&nbsp;size];&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGImageRef&nbsp;marsLeft&nbsp;=&nbsp;CGImageCreateWithImageInRect([mars&nbsp;CGImage],CGRectMake(0,0,sz.width/2.0,sz.height));&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGImageRef&nbsp;marsRight&nbsp;=&nbsp;CGImageCreateWithImageInRect([mars&nbsp;CGImage],CGRectMake(sz.width/2.0,0,sz.width/2.0,sz.height));&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit"><span class="comment" style="margin:0px; padding:0px; border:none; color:rgb(0,130,0); background-color:inherit">//&nbsp;将每一个CGImage绘制到图形上下文中</span><span style="margin:0px; padding:0px; border:none; background-color:inherit">&nbsp;</span></span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">UIGraphicsBeginImageContextWithOptions(CGSizeMake(sz.width*1.5,&nbsp;sz.height),&nbsp;NO,&nbsp;0);&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGContextRef&nbsp;con&nbsp;=&nbsp;UIGraphicsGetCurrentContext();&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGContextDrawImage(con,&nbsp;CGRectMake(0,0,sz.width/2.0,sz.height),&nbsp;marsLeft);&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGContextDrawImage(con,&nbsp;CGRectMake(sz.width,0,sz.width/2.0,sz.height),&nbsp;marsRight);&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">UIImage*&nbsp;im&nbsp;=&nbsp;UIGraphicsGetImageFromCurrentImageContext();&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">UIGraphicsEndImageContext();&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit"><span class="comment" style="margin:0px; padding:0px; border:none; color:rgb(0,130,0); background-color:inherit">//&nbsp;记得释放内存，ARC在这里无效</span><span style="margin:0px; padding:0px; border:none; background-color:inherit">&nbsp;</span></span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGImageRelease(marsLeft);&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGImageRelease(marsRight);&nbsp;</span></li></ol></pre>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
你也许发现绘出的图是上下颠倒的！图片的颠倒并不是因为被旋转了。当你创建了一个CGImage并使用CGContextDrawImage方法绘图就会引起这种问题。这主要是因为原始的本地坐标系统（坐标原点在左上角）与目标上下文（坐标原点在左下角）不匹配。有很多方法可以修复这个问题，其中一种方法就是使用CGContextDrawImage方法先将CGImage绘制到UIImage上，然后获取UIImage对应的CGImage，此时就得到了一个倒转的CGImage。当再调用CGContextDrawImage方法，我们就将倒转的图片还原回来了。实现代码如下：</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<pre style="margin-top:0px; margin-bottom:1em; padding:0px; font-family:'Courier New',monospace; width:662.296875px; overflow:auto; background-color:rgb(247,247,247); color:rgb(51,51,51)"><ol class="dp-c" style="padding:5px 0px; list-style-position:initial; border-style:none none none solid; border-left-width:3px; border-left-color:rgb(20,107,0); color:rgb(92,92,92); margin:0px 0px 1px 3em!important"><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGImageRef&nbsp;flip&nbsp;(CGImageRef&nbsp;im)&nbsp;{&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGSize&nbsp;sz&nbsp;=&nbsp;CGSizeMake(CGImageGetWidth(im),&nbsp;CGImageGetHeight(im));&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">UIGraphicsBeginImageContextWithOptions(sz,&nbsp;NO,&nbsp;0);&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGContextDrawImage(UIGraphicsGetCurrentContext(),&nbsp;CGRectMake(0,&nbsp;0,&nbsp;sz.width,&nbsp;sz.height),&nbsp;im);&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGImageRef&nbsp;result&nbsp;=&nbsp;[UIGraphicsGetImageFromCurrentImageContext()&nbsp;CGImage];&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">UIGraphicsEndImageContext();&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit"><span class="keyword" style="margin:0px; padding:0px; border:none; color:rgb(0,102,153); background-color:inherit; font-weight:bold">return</span><span style="margin:0px; padding:0px; border:none; background-color:inherit">&nbsp;result;&nbsp;</span></span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">}&nbsp;</span></li></ol></pre>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
现在将之前的代码修改如下：</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<pre style="margin-top:0px; margin-bottom:1em; padding:0px; font-family:'Courier New',monospace; width:662.296875px; overflow:auto; background-color:rgb(247,247,247); color:rgb(51,51,51)"><ol class="dp-c" style="padding:5px 0px; list-style-position:initial; border-style:none none none solid; border-left-width:3px; border-left-color:rgb(20,107,0); color:rgb(92,92,92); margin:0px 0px 1px 3em!important"><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGContextDrawImage(con,&nbsp;CGRectMake(0,0,sz.width/2.0,sz.height),&nbsp;flip(marsLeft));&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGContextDrawImage(con,&nbsp;CGRectMake(sz.width,0,sz.width/2.0,sz.height),&nbsp;flip(marsRight));&nbsp;</span></li></ol></pre>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
然而，这里又出现了另外一个问题：在双分辨率的设备上，如果我们的图片文件是高分辨率（@2x）版本，上面的绘图就是错误的。原因在于对于UIImage来说，在加载原始图片时使用imageNamed:方法，它会自动根据所在设备的分辨率类型选择图片，并且UIImage通过设置用来适配的scale属性补偿图片的两倍尺寸。但是一个CGImage对象并没有scale属性，它不知道图片文件的尺寸是否为两倍！所以当调用UIImage的CGImage方法，你不能假定所获得的CGImage尺寸与原始UIImage是一样的。在单分辨率和双分辨率下，一个UIImage对象的size属性&#20540;都是一样的，但是双分辨率UIImage对应的CGImage是单分辨率UIImage对应的CGImage的两倍大。所以我们需要修改上面的代码，让其在单双分辨率下都可以工作。代码如下：</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<pre style="margin-top:0px; margin-bottom:1em; padding:0px; font-family:'Courier New',monospace; width:662.296875px; overflow:auto; background-color:rgb(247,247,247); color:rgb(51,51,51)"><ol class="dp-c" style="padding:5px 0px; list-style-position:initial; border-style:none none none solid; border-left-width:3px; border-left-color:rgb(20,107,0); color:rgb(92,92,92); margin:0px 0px 1px 3em!important"><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit"><span style="margin:0px; padding:0px; border:none; background-color:inherit">UIImage*&nbsp;mars&nbsp;=&nbsp;[UIImage&nbsp;imageNamed:@</span><span class="string" style="margin:0px; padding:0px; border:none; color:blue; background-color:inherit">&quot;Mars.png&quot;</span><span style="margin:0px; padding:0px; border:none; background-color:inherit">];&nbsp;</span></span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGSize&nbsp;sz&nbsp;=&nbsp;[mars&nbsp;size];&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit"><span class="comment" style="margin:0px; padding:0px; border:none; color:rgb(0,130,0); background-color:inherit">//&nbsp;转换CGImage并使用对应的CGImage尺寸截取图片的左右部分</span><span style="margin:0px; padding:0px; border:none; background-color:inherit">&nbsp;</span></span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGImageRef&nbsp;marsCG&nbsp;=&nbsp;[mars&nbsp;CGImage];&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGSize&nbsp;szCG&nbsp;=&nbsp;CGSizeMake(CGImageGetWidth(marsCG),&nbsp;CGImageGetHeight(marsCG));&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGImageRef&nbsp;marsLeft&nbsp;=&nbsp;CGImageCreateWithImageInRect(marsCG,CGRectMake(0,0,szCG.width/2.0,szCG.height));&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGImageRef&nbsp;marsRight&nbsp;=&nbsp;CGImageCreateWithImageInRect(marsCG,&nbsp;CGRectMake(szCG.width/2.0,0,szCG.width/2.0,szCG.height));&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">UIGraphicsBeginImageContextWithOptions(CGSizeMake(sz.width*1.5,&nbsp;sz.height),&nbsp;NO,&nbsp;0);&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit"><span class="comment" style="margin:0px; padding:0px; border:none; color:rgb(0,130,0); background-color:inherit">//剩下的和之前的代码一样，修复倒置问题</span><span style="margin:0px; padding:0px; border:none; background-color:inherit">&nbsp;</span></span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGContextRef&nbsp;con&nbsp;=&nbsp;UIGraphicsGetCurrentContext();&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGContextDrawImage(con,&nbsp;CGRectMake(0,0,sz.width/2.0,sz.height),flip(marsLeft));&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGContextDrawImage(con,&nbsp;CGRectMake(sz.width,0,sz.width/2.0,sz.height),flip(marsRight));&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">UIImage*&nbsp;im&nbsp;=&nbsp;UIGraphicsGetImageFromCurrentImageContext();&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">UIGraphicsEndImageContext();&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGImageRelease(marsLeft);&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGImageRelease(marsRight);&nbsp;</span></li></ol></pre>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
上面的代码初看上去很繁杂，不过不用担心，这里还有另一种修复倒置问题的方案。相对于使用flip函数，你可以在绘图之前将CGImage包装进UIImage中，这样做有两大优点：</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
1.当UIImage绘图时它会自动修复倒置问题</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
2.当你从CGImage转化为Uimage时，可调用imageWithCGImage:scale:orientation:方法生成CGImage作为对缩放性的补偿。</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
所以这是一个解决倒置和缩放问题的自包含方法。</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
代码如下：</div>
<pre style="margin-top:0px; margin-bottom:1em; padding:0px; font-family:'Courier New',monospace; width:662.296875px; overflow:auto; background-color:rgb(247,247,247); color:rgb(51,51,51)"><ol class="dp-c" style="padding:5px 0px; list-style-position:initial; border-style:none none none solid; border-left-width:3px; border-left-color:rgb(20,107,0); color:rgb(92,92,92); margin:0px 0px 1px 3em!important"><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit"><span style="margin:0px; padding:0px; border:none; background-color:inherit">UIImage*&nbsp;mars&nbsp;=&nbsp;[UIImage&nbsp;imageNamed:@</span><span class="string" style="margin:0px; padding:0px; border:none; color:blue; background-color:inherit">&quot;Mars.png&quot;</span><span style="margin:0px; padding:0px; border:none; background-color:inherit">];&nbsp;</span></span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGSize&nbsp;sz&nbsp;=&nbsp;[mars&nbsp;size];&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGImageRef&nbsp;marsCG&nbsp;=&nbsp;[mars&nbsp;CGImage];&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGSize&nbsp;szCG&nbsp;=&nbsp;CGSizeMake(CGImageGetWidth(marsCG),&nbsp;CGImageGetHeight(marsCG));&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGImageRef&nbsp;marsLeft&nbsp;=&nbsp;CGImageCreateWithImageInRect(marsCG,&nbsp;CGRectMake(0,0,szCG.width/2.0,szCG.height));&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGImageRef&nbsp;marsRight&nbsp;=&nbsp;CGImageCreateWithImageInRect(marsCG,&nbsp;CGRectMake(szCG.width/2.0,0,szCG.width/2.0,szCG.height));&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">UIGraphicsBeginImageContextWithOptions(CGSizeMake(sz.width*1.5,&nbsp;sz.height),&nbsp;NO,&nbsp;0);&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">[[UIImage&nbsp;imageWithCGImage:marsLeft&nbsp;scale:[mars&nbsp;scale]&nbsp;orientation:UIImageOrientationUp]&nbsp;drawAtPoint:CGPointMake(0,0)];&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">[[UIImage&nbsp;imageWithCGImage:marsRight&nbsp;scale:[mars&nbsp;scale]&nbsp;orientation:UIImageOrientationUp]&nbsp;drawAtPoint:CGPointMake(sz.width,0)];&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">UIImage*&nbsp;im&nbsp;=&nbsp;UIGraphicsGetImageFromCurrentImageContext();&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">UIGraphicsEndImageContext();&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGImageRelease(marsLeft);&nbsp;CGImageRelease(marsRight);&nbsp;&nbsp;</span></li></ol></pre>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
还有另一种解决倒置问题的方案是在绘制CGImage之前，对上下文应用变换操作，有效地倒置上下文的内部坐标系统。这里先不做讨论。</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
<strong>为什么会发生倒置问题</strong></div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
究其原因是因为Core Graphics源于Mac OS X系统，在Mac OS X中，坐标原点在左下方并且正y坐标是朝上的，而在iOS中，原点坐标是在左上方并且正y坐标是朝下的。在大多数情况下，这不会出现任何问题，因为图形上下文的坐标系统是会自动调节补偿的。但是创建和绘制一个CGImage对象时就会暴露出倒置问题。</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
<strong>CIFilter与CIImage</strong></div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
CIFilter与CIImage是iOS 5新引入的，虽然它们已在MAX OS X系统中存在多年。前缀“CI”表示Core Image，这是一种使用数学滤镜变换图片的技术。但是你不要去幻想iOS提供了像Photoshop软件那样强大的滤镜功能。使用Core Image之前你需要将CoreImage.framework框架导入到你的target之中。</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
所谓滤镜指的是CIFilter类，滤镜可被分为以下几类：</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
<span style="color:rgb(128,0,0)">模板与渐变类</span></div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
这两类滤镜创建的CIImage可以和其他的CIImage进行合并，比如一种单色，一个棋盘，条纹，亦或是渐变。</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
<span style="color:rgb(128,0,0)">合成类</span></div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
此类滤镜可以将一张图片与另外的图片合并，合成滤镜模式常见于图形处理软件Photoshop中。</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
<span style="color:rgb(128,0,0)">色彩类</span></div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
此滤镜调整、修改图片的色彩。因此你可以改变一张图片的饱和度、色度、亮度、对比度、伽马、白点、曝光度、阴影、高亮等属性。</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
<span style="color:rgb(128,0,0)">几何变换类</span></div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
此类滤镜可对图片执行基本的几何变换，比如缩放、旋转、裁剪。</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
CIFilter使用起来非常的简单。CIFilter看上去就像一个由键&#20540;组成的字典。它生成一个CIImage对象作为其输出。一般地，一个滤镜有一个或多个输入，而对于部分滤镜，生成的图片是基于其他类型的参数&#20540;。CIFilter对象是一个集合，可使用键&#20540;对进行检索。通过提供滤镜的字符串名称创建一个滤镜，如果想知道有哪些滤镜，可以查询苹果的<a target="_blank" href="https://developer.apple.com/library/mac/documentation/graphicsimaging/reference/CoreImageFilterReference/Reference/reference.html" target="_blank" style="font-size:12px; line-height:normal; text-decoration:none; color:rgb(102,102,102)"><span style="color:rgb(0,0,255)">Core
 Image Filter Reference</span></a>文档，或是调用CIFilter的类方法filterNamesInCategories：，参数&#20540;为nil。每一个滤镜拥有一小部分用来确定其行为的键&#20540;。如果你想修改某一个键（比如亮度键）对应的&#20540;，你可以调用setValue：forKey：方法或当你指定一个滤镜名时提供所有键&#20540;对。</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
需要处理的图片必须是CIImage类型，调用initWithCGImage：方法可获得CIImage。因为CGImage又是作为滤镜的输出，因此滤镜之间可被连接在一起（将滤镜的输出作为initWithCGImage：方法的输入参数）</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
当你构建一个滤镜链时，并没有做复杂的运算。只有当整个滤镜链需要输出一个CGImage时，密集型计算才会发生。调用contextWithOptions：和createCGImage: fromRect:方法创建CIContext。与以往不同的地方是CIImage没有frame与bounds属性；只有extent属性。你将非常频繁的使用这个属性作为createCGImage: fromRect:方法的第二个参数。</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
接下来我将演示Core Image的使用。首先创建一个径向渐变的滤镜，该滤镜是从白到黑的渐变方式，白色区域的半径默认是100。接着将其与一张使用CIDarkenBlendMode滤镜的图片合成。CIDarkenBlendMode的作用是背景图片样本将被源图片的黑色部分替换掉。</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
代码如下：</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<pre style="margin-top:0px; margin-bottom:1em; padding:0px; font-family:'Courier New',monospace; width:662.296875px; overflow:auto; background-color:rgb(247,247,247); color:rgb(51,51,51)"><ol class="dp-c" style="padding:5px 0px; list-style-position:initial; border-style:none none none solid; border-left-width:3px; border-left-color:rgb(20,107,0); color:rgb(92,92,92); margin:0px 0px 1px 3em!important"><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit"><span style="margin:0px; padding:0px; border:none; background-color:inherit">UIImage*&nbsp;moi&nbsp;=&nbsp;[UIImage&nbsp;imageNamed:@</span><span class="string" style="margin:0px; padding:0px; border:none; color:blue; background-color:inherit">&quot;Mars.jpeg&quot;</span><span style="margin:0px; padding:0px; border:none; background-color:inherit">];&nbsp;</span></span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CIImage*&nbsp;moi2&nbsp;=&nbsp;[[CIImage&nbsp;alloc]&nbsp;initWithCGImage:moi.CGImage];&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CIFilter*&nbsp;grad&nbsp;=&nbsp;[CIFilter&nbsp;filterWithName:@<span class="string" style="margin:0px; padding:0px; border:none; color:blue; background-color:inherit">&quot;CIRadialGradient&quot;</span><span style="margin:0px; padding:0px; border:none; background-color:inherit">];&nbsp;</span></span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CIVector*&nbsp;center&nbsp;=&nbsp;[CIVector&nbsp;vectorWithX:moi.size.width&nbsp;/&nbsp;2.0&nbsp;Y:moi.size.height&nbsp;/&nbsp;2.0];&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit"><span class="comment" style="margin:0px; padding:0px; border:none; color:rgb(0,130,0); background-color:inherit">//&nbsp;使用setValue：forKey：方法设置滤镜属性</span><span style="margin:0px; padding:0px; border:none; background-color:inherit">&nbsp;</span></span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">[grad&nbsp;setValue:center&nbsp;forKey:@<span class="string" style="margin:0px; padding:0px; border:none; color:blue; background-color:inherit">&quot;inputCenter&quot;</span><span style="margin:0px; padding:0px; border:none; background-color:inherit">];&nbsp;</span></span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit"><span class="comment" style="margin:0px; padding:0px; border:none; color:rgb(0,130,0); background-color:inherit">//&nbsp;在指定滤镜名时提供所有滤镜键&#20540;对</span><span style="margin:0px; padding:0px; border:none; background-color:inherit">&nbsp;</span></span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CIFilter*&nbsp;dark&nbsp;=&nbsp;[CIFilter&nbsp;filterWithName:@<span class="string" style="margin:0px; padding:0px; border:none; color:blue; background-color:inherit">&quot;CIDarkenBlendMode&quot;</span><span style="margin:0px; padding:0px; border:none; background-color:inherit">&nbsp;keysAndValues:@</span><span class="string" style="margin:0px; padding:0px; border:none; color:blue; background-color:inherit">&quot;inputImage&quot;</span><span style="margin:0px; padding:0px; border:none; background-color:inherit">,&nbsp;grad.outputImage,&nbsp;@</span><span class="string" style="margin:0px; padding:0px; border:none; color:blue; background-color:inherit">&quot;inputBackgroundImage&quot;</span><span style="margin:0px; padding:0px; border:none; background-color:inherit">,&nbsp;moi2,&nbsp;nil];&nbsp;</span></span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CIContext*&nbsp;c&nbsp;=&nbsp;[CIContext&nbsp;contextWithOptions:nil];&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGImageRef&nbsp;moi3&nbsp;=&nbsp;[c&nbsp;createCGImage:dark.outputImage&nbsp;fromRect:moi2.extent];&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">UIImage*&nbsp;moi4&nbsp;=&nbsp;[UIImage&nbsp;imageWithCGImage:moi3&nbsp;scale:moi.scale&nbsp;orientation:moi.imageOrientation];&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGImageRelease(moi3);&nbsp;</span></li></ol></pre>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px; text-align:center">
<img src="http://www.cocoachina.com/cms/uploads/allimg/140115/4196_140115114008_1.png" width="619" border="0" height="181" alt="" style="border:0px; max-width:700px; margin:10px 0px"></div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px; text-align:center">
图4 图片合成快照</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
这个例子可能没有什么吸引人的地方，因为所有一切都可以使用Core Graphics完成。除了Core Image是使用GPU处理，可能有点吸引人。Core Graphics也可以做到径向渐变并使用混合模式合成图片。但Core Image要简单得多，特别是当你有多个图片输入想重用一个滤镜链时。并且Core Image的颜色调整功能比Core Graphics更加强大。对了，Core Image还能实现自动人脸识别哦！</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
<strong>绘制一个UIView</strong></div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
绘制一个UIVIew最灵活的方式就是由它自己完成绘制。实际上你不是绘制一个UIView，你只是子类化了UIView并赋予子类绘制自己的能力。当一个UIVIew需要执行绘图操作的时， drawRect:方法就会被调用。覆盖此方法让你获得绘图操作的机会。当drawRect：方法被调用，当前图形上下文也被设置为属于视图的图形上下文。你可以使用Core Graphics或UIKit提供的方法将图形画到该上下文中。</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
你不应该手动调用drawRect：方法！如果你想调用drawRect：方法更新视图，只需发送setNeedsDisplay方法。这将使得drawRect：方法会在下一个适当的时间调用。当然，不要覆盖drawRect：方法除非你知道这样做绝对合法。比方说，在UIImageView子类中覆盖drawRect：方法是不合法的，你将得不到你绘制的图形。</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
在UIView子类的drawRect：方法中无需调用super，因为本身UIView的drawRect：方法是空的。为了提高一些绘图性能，你可以调用setNeedsDisplayInRect方法重新绘制视图的子区域，而视图的其他部分依然保持不变。</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
一般情况下，你不应该过早的进行优化。绘图代码可能看上去非常的繁琐，但它们是非常快的。并且iOS绘图系统自身也是非常高效，它不会频繁调用drawRect：方法，除非迫不得已（或调用了setNeedsDisplay方法）。一旦一个视图已由自己绘制完成，那么绘制的结果会被缓存下来留待重用，而不是每次重头再来。(苹果公司将缓存绘图称为视图的位图存储回填（bitmap backing store）)。你可能会发现drawRect：方法中的代码在整个应用程序生命周期内只被调用了一次！事实上，将代码移到drawRect：方法中是提高性能的普遍做法。这是因为绘图引擎直接对屏幕进行渲染相对于先是脱屏渲染然后再将像素拷贝到屏幕要来的高效。</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
当视图的backgroundColor为nil并且opaque属性为YES，视图的背景颜色就会变成黑色。</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
<strong>Core Graphics上下文属性设置</strong></div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
当你在图形上下文中绘图时，当前图形上下文的相关属性设置将决定绘图的行为与外观。因此，绘图的一般过程是先设定好图形上下文参数，然后绘图。比方说，要画一根红线，接着画一根蓝线。那么首先需要将上下文的线条颜色属性设定为为红色，然后画红线；接着设置上下文的线条颜色属性为蓝色，再画出蓝线。表面上看,红线和蓝线是分开的，但事实上，在你画每一条线时，线条颜色却是整个上下文的属性。无论你用的是UIKit方法还是Core Graphics函数。</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
因为图形上下文在每一时刻都有一个确定的状态，该状态概括了图形上下文所有属性的设置。为了便于操作这些状态，图形上下文提供了一个用来持有状态的栈。调用CGContextSaveGState函数，上下文会将完整的当前状态压入栈顶；调用CGContextRestoreGState函数，上下文查找处在栈顶的状态，并设置当前上下文状态为栈顶状态。</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
因此一般绘图模式是：在绘图之前调用CGContextSaveGState函数保存当前状态，接着根据需要设置某些上下文状态，然后绘图，最后调用CGContextRestoreGState函数将当前状态恢复到绘图之前的状态。要注意的是，CGContextSaveGState函数和CGContextRestoreGState函数必须成对出现，否则绘图很可能出现意想不到的错误，这里有一个简单的做法避免这种情况。代码如下：</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<pre style="margin-top:0px; margin-bottom:1em; padding:0px; font-family:'Courier New',monospace; width:662.296875px; overflow:auto; background-color:rgb(247,247,247); color:rgb(51,51,51)"><ol class="dp-c" style="padding:5px 0px; list-style-position:initial; border-style:none none none solid; border-left-width:3px; border-left-color:rgb(20,107,0); color:rgb(92,92,92); margin:0px 0px 1px 3em!important"><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit"><span style="margin:0px; padding:0px; border:none; background-color:inherit">-&nbsp;(</span><span class="keyword" style="margin:0px; padding:0px; border:none; color:rgb(0,102,153); background-color:inherit; font-weight:bold">void</span><span style="margin:0px; padding:0px; border:none; background-color:inherit">)drawRect:(CGRect)rect&nbsp;{&nbsp;</span></span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGContextRef&nbsp;ctx&nbsp;=&nbsp;UIGraphicsGetCurrentContext();&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGContextSaveGState(ctx);&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">{&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit"><span class="comment" style="margin:0px; padding:0px; border:none; color:rgb(0,130,0); background-color:inherit">//&nbsp;绘图代码</span><span style="margin:0px; padding:0px; border:none; background-color:inherit">&nbsp;</span></span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">}&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGContextRestoreGState(ctx);&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;　&nbsp;</span></li></ol></pre>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
但你不需要在每次修改上下文状态之前都这样做，因为你对某一上下文属性的设置并不一定会和之前的属性设置或其他的属性设置产生冲突。你完全可以在不调用保存和恢复函数的情况下先设置线条颜色为红色，然后再设置为蓝色。但在一定情况下，你希望你对状态的设置是可撤销的，我将在接下来讨论这样的情况。</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
许多的属性组成了一个图形上下文状态，这些属性设置决定了在你绘图时图形的外观和行为。下面我列出了一些属性和对应修改属性的函数；虽然这些函数是关于Core Graphics的，但记住，实际上UIKit同样是调用这些函数操纵上下文状态。</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
线条的宽度和线条的虚线样式</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
<span style="color:rgb(128,0,0)">CGContextSetLineWidth、CGContextSetLineDash</span></div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
线帽和线条联接点样式</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
<span style="color:rgb(128,0,0)">CGContextSetLineCap、CGContextSetLineJoin、CGContextSetMiterLimit</span></div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
线条颜色和线条模式</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
<span style="color:rgb(128,0,0)">CGContextSetRGBStrokeColor、CGContextSetGrayStrokeColor、CGContextSetStrokeColorWithColor、CGContextSetStrokePattern</span></div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
填充颜色和模式</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
<span style="color:rgb(128,0,0)">CGContextSetRGBFillColor,CGContextSetGrayFillColor,CGContextSetFillColorWithColor, CGContextSetFillPattern</span></div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
阴影</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
<span style="color:rgb(128,0,0)">CGContextSetShadow、CGContextSetShadowWithColor</span></div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
混合模式</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
<span style="color:rgb(128,0,0)">CGContextSetBlendMode（决定你当前绘制的图形与已经存在的图形如何被合成）</span></div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
整体透明度</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
<span style="color:rgb(128,0,0)">CGContextSetAlpha（个别颜色也具有alpha成分）</span></div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
文本属性</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
<span style="color:rgb(128,0,0)">CGContextSelectFont、CGContextSetFont、CGContextSetFontSize、CGContextSetTextDrawingMode、CGContextSetCharacterSpacing</span></div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
是否开启反锯齿和字体平滑</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
<span style="color:rgb(128,0,0)">CGContextSetShouldAntialias、CGContextSetShouldSmoothFonts</span></div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
<span style="color:rgb(51,153,102)">另外一些属性设置：</span></div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
<span style="color:rgb(0,0,0)">裁剪区域:</span>在裁剪区域外绘图不会被实际的画出来。</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
变换（或称为“CTM“，意为当前变换矩阵): 改变你随后指定的绘图命令中的点如何被映射到画布的物理空间。</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
许多这些属性设置接下来我都会举例说明。</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
<span style="color:rgb(128,0,0)">路径与绘图</span></div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
通过编写移动虚拟画笔的代码描画一段路径，这样的路径并不构成一个图形。绘制路径意味着对路径描边或填充该路径，也或者两者都做。同样，你应该从某些绘图程序中得到过相&#20284;的体会。</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
一段路径是由点到点的描画构成。想象一下绘图系统是你手里的一只画笔，你首先必须要设置画笔当前所处的位置，然后给出一系列命令告诉画笔如何描画随后的每段路径。每一段新增的路径开始于当前点，当完成一条路径的描画，路径的终点就变成了当前点。</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
下面列出了一些路径描画的命令：</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
定位当前点</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
<span style="color:rgb(128,0,0)">CGContextMoveToPoint</span></div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
描画一条线</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
<span style="color:rgb(128,0,0)">CGContextAddLineToPoint、CGContextAddLines</span></div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
描画一个矩形</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
<span style="color:rgb(128,0,0)">CGContextAddRect、CGContextAddRects</span></div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
描画一个椭圆或圆形</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
<span style="color:rgb(128,0,0)">CGContextAddEllipseInRect</span></div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
描画一段圆弧</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
<span style="color:rgb(128,0,0)">CGContextAddArcToPoint、CGContextAddArc</span></div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
通过一到两个控制点描画一段贝赛尔曲线</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
<span style="color:rgb(128,0,0)">CGContextAddQuadCurveToPoint、CGContextAddCurveToPoint</span></div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
关闭当前路径</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
<span style="color:rgb(128,0,0)">CGContextClosePath 这将从路径的终点到起点追加一条线。如果你打算填充一段路径，那么就不需要使用该命令，因为该命令会被自动调用。</span></div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
描边或填充当前路径</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
<span style="color:rgb(128,0,0)">CGContextStrokePath、CGContextFillPath、CGContextEOFillPath、CGContextDrawPath</span>。对当前路径描边或填充会清除掉路径。如果你只想使用一条命令完成描边和填充任务，可以使用CGContextDrawPath命令，因为如果你只是使用CGContextStrokePath对路径描边，路径就会被清除掉，你就不能再对它进行填充了。</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
创建路径并描边路径或填充路径只需一条命令就可完成的函数：<span style="color:rgb(128,0,0)">CGContextStrokeLineSegments、CGContextStrokeRect、CGContextStrokeRectWithWidth、CGContextFillRect、CGContextFillRects、CGContextStrokeEllipseInRect、CGContextFillEllipseInRect。</span></div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
一段路径是被合成的，意思是它是由多条独立的路径组成。举个例子，一条单独的路径可能由两个独立的闭合形状组成：一个矩形和一个圆形。当你在构造一条路径的中间过程（意思是在描画了一条路径后没有调用描边或填充命令，或调用CGContextBeginPath函数来清除路径）调用CGContextMoveToPoint函数，就像是你拾起画笔，并将画笔移动到一个新的位置，如此来准备开始一段独立的相同路径。如果你担心当你开始描画一条路径的时候，已经存在的路径和新的路径会被认为是已存在路径的一个合成部分，你可以调用CGContextBeginPath函数指定你绘制的路径是一条独立的路径；苹果的许多例子都是这样做的，但在实际开发中我发现这是非必要的。</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
CGContextClearRect函数的功能是擦除一个区域。这个函数会擦除一个矩形内的所有已存在的绘图；并对该区域执行裁剪。结果像是打了一个贯穿所有已存在绘图的孔。</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
CGContextClearRect函数的行为依赖于上下文是透明还是不透明。当在图形上下文中绘图时，这会尤为明显和直观。如果图片上下文是透明的（UIGraphicsBeginImageContextWithOptions第二个参数为NO），那么CGContextClearRect函数执行擦除后的颜色为透明，反之则为黑色。</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
当在一个视图中直接绘图（使用drawRect：或drawLayer：inContext：方法），如果视图的背景颜色为nil或颜色哪怕有一点点透明度，那么CGContextClearRect的矩形区域将会显示为透明的，打出的孔将穿过视图包括它的背景颜色。如果背景颜色完全不透明，那么CGContextClearRect函数的结果将会是黑色。这是因为视图的背景颜色决定了是否视图的图形上下文是透明的还是不透明的。</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px; text-align:center">
<img src="http://www.cocoachina.com/cms/uploads/allimg/140115/4196_140115114752_1.png" width="276" border="0" height="116" alt="" style="border:0px; max-width:700px; margin:10px 0px"></div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px; text-align:center">
图5 CGContextClearRect函数的应用</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
如图5，在左边的蓝色正方形被挖去部分留为黑色，然而在右边的蓝色正方形也被挖去部分留为透明。但这两个正方形都是UIView子类的实例，采用相同的绘图代码！不同之处在于视图的背景颜色，左边的正方形的背景颜色在nib文件中</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
但是这却完全改变了CGContextClearRect函数的效果。UIView子类的drawRect：方法看起来像这样：</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<pre style="margin-top:0px; margin-bottom:1em; padding:0px; font-family:'Courier New',monospace; width:662.296875px; overflow:auto; background-color:rgb(247,247,247); color:rgb(51,51,51)"><ol class="dp-c" style="padding:5px 0px; list-style-position:initial; border-style:none none none solid; border-left-width:3px; border-left-color:rgb(20,107,0); color:rgb(92,92,92); margin:0px 0px 1px 3em!important"><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGContextRef&nbsp;con&nbsp;=&nbsp;UIGraphicsGetCurrentContext();&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGContextSetFillColorWithColor(con,&nbsp;[UIColor&nbsp;blueColor].CGColor);&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGContextFillRect(con,&nbsp;rect);&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGContextClearRect(con,&nbsp;CGRectMake(0,0,30,30));&nbsp;</span></li></ol></pre>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
为了说明典型路径的描画命令，我将生成一个向上的箭头图案，我谨慎避免使用便利函数操作，也许这不是创建箭头最好的方式，但依然清楚的展示了各种典型命令的用法。</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px; text-align:center">
<img src="http://www.cocoachina.com/cms/uploads/allimg/140115/4196_140115114839_1.png" width="252" border="0" height="122" alt="" style="border:0px; max-width:700px; margin:10px 0px"></div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px; text-align:center">
图6 一个简单的路径绘图</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<pre style="margin-top:0px; margin-bottom:1em; padding:0px; font-family:'Courier New',monospace; width:662.296875px; overflow:auto; background-color:rgb(247,247,247); color:rgb(51,51,51)"><ol class="dp-c" style="padding:5px 0px; list-style-position:initial; border-style:none none none solid; border-left-width:3px; border-left-color:rgb(20,107,0); color:rgb(92,92,92); margin:0px 0px 1px 3em!important"><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGContextRef&nbsp;con&nbsp;=&nbsp;UIGraphicsGetCurrentContext();&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit"><span class="comment" style="margin:0px; padding:0px; border:none; color:rgb(0,130,0); background-color:inherit">//&nbsp;绘制一个黑色的垂直黑色线，作为箭头的杆子</span><span style="margin:0px; padding:0px; border:none; background-color:inherit">&nbsp;</span></span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGContextMoveToPoint(con,&nbsp;100,&nbsp;100);&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGContextAddLineToPoint(con,&nbsp;100,&nbsp;19);&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGContextSetLineWidth(con,&nbsp;20);&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGContextStrokePath(con);&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit"><span class="comment" style="margin:0px; padding:0px; border:none; color:rgb(0,130,0); background-color:inherit">//&nbsp;绘制一个红色三角形箭头</span><span style="margin:0px; padding:0px; border:none; background-color:inherit">&nbsp;</span></span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGContextSetFillColorWithColor(con,&nbsp;[[UIColor&nbsp;redColor]&nbsp;CGColor]);&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGContextMoveToPoint(con,&nbsp;80,&nbsp;25);&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGContextAddLineToPoint(con,&nbsp;100,&nbsp;0);&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGContextAddLineToPoint(con,&nbsp;120,&nbsp;25);&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGContextFillPath(con);&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit"><span class="comment" style="margin:0px; padding:0px; border:none; color:rgb(0,130,0); background-color:inherit">//&nbsp;从箭头杆子上裁掉一个三角形，使用清除混合模式</span><span style="margin:0px; padding:0px; border:none; background-color:inherit">&nbsp;</span></span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGContextMoveToPoint(con,&nbsp;90,&nbsp;101);&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGContextAddLineToPoint(con,&nbsp;100,&nbsp;90);&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGContextAddLineToPoint(con,&nbsp;110,&nbsp;101);&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGContextSetBlendMode(con,&nbsp;kCGBlendModeClear);&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGContextFillPath(con);&nbsp;</span></li></ol></pre>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
确切的说，为了以防万一，我们应该在绘图代码周围使用<span style="color:rgb(128,0,0)">CGContextSaveGState和CGContextRestoreGState</span>函数。可对于这个例子来说，添加与否不会有任何的区别。因为上下文在调用drawRect：方法中不会被持久，所以不会被破坏。</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
如果一段路径需要重用或共享，你可以将路径封装为CGPath（具体类型是CGPathRef）。你可以创建一个新的CGMutablePathRef对象并使用多个类&#20284;于图形的路径函数的CGPath函数构造路径，或者使用CGContextCopyPath函数复制图形上下文的当前路径。有许多CGPath函数可用于创建基于简单几何形状的路径（<span style="color:rgb(128,0,0)">CGPathCreateWithRect、CGPathCreateWithEllipseInRect</span>）或基于已存在路径（<span style="color:rgb(128,0,0)">CGPathCreateCopyByStrokingPath、CGPathCreateCopyDashingPath、CGPathCreateCopyByTransformingPath</span>）。</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
UIKit的UIBezierPath类包装了CGPath。它提供了用于绘制某种形状路径的方法，以及用于描边、填充、存取某些当前上下文状态的设置方法。类&#20284;地，UIColor提供了用于设置当前上下文描边与填充的颜色。因此我们可以重写我们之前绘制箭头的代码：</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<pre style="margin-top:0px; margin-bottom:1em; padding:0px; font-family:'Courier New',monospace; width:662.296875px; overflow:auto; background-color:rgb(247,247,247); color:rgb(51,51,51)"><ol class="dp-c" style="padding:5px 0px; list-style-position:initial; border-style:none none none solid; border-left-width:3px; border-left-color:rgb(20,107,0); color:rgb(92,92,92); margin:0px 0px 1px 3em!important"><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">UIBezierPath*&nbsp;p&nbsp;=&nbsp;[UIBezierPath&nbsp;bezierPath];&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">[p&nbsp;moveToPoint:CGPointMake(100,100)];&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">[p&nbsp;addLineToPoint:CGPointMake(100,&nbsp;19)];&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">[p&nbsp;setLineWidth:20];&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">[p&nbsp;stroke];&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">[[UIColor&nbsp;redColor]&nbsp;set];&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">[p&nbsp;removeAllPoints];&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">[p&nbsp;moveToPoint:CGPointMake(80,25)];&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">[p&nbsp;addLineToPoint:CGPointMake(100,&nbsp;0)];&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">[p&nbsp;addLineToPoint:CGPointMake(120,&nbsp;25)];&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">[p&nbsp;fill];&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">[p&nbsp;removeAllPoints];&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">[p&nbsp;moveToPoint:CGPointMake(90,101)];&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">[p&nbsp;addLineToPoint:CGPointMake(100,&nbsp;90)];&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">[p&nbsp;addLineToPoint:CGPointMake(110,&nbsp;101)];&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">[p&nbsp;fillWithBlendMode:kCGBlendModeClear&nbsp;alpha:1.0];&nbsp;</span></li></ol></pre>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
在这种特殊情况下，完成同样的工作并没有节省多少代码，但是UIBezierPath仍然还是有用的。如果你需要对象特性，UIBezierPath提供了一个便利方法：bezierPathWithRoundedRect：cornerRadius：，它可用于绘制带有圆角的矩形，如果是使用Core Graphics就相当冗长乏味了。还可以只让圆角出现在左上角和右上角。</div>
<pre style="margin-top:0px; margin-bottom:1em; padding:0px; font-family:'Courier New',monospace; width:662.296875px; overflow:auto; background-color:rgb(247,247,247); color:rgb(51,51,51)"><ol class="dp-c" style="padding:5px 0px; list-style-position:initial; border-style:none none none solid; border-left-width:3px; border-left-color:rgb(20,107,0); color:rgb(92,92,92); margin:0px 0px 1px 3em!important"><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit"><span style="margin:0px; padding:0px; border:none; background-color:inherit">-&nbsp;(</span><span class="keyword" style="margin:0px; padding:0px; border:none; color:rgb(0,102,153); background-color:inherit; font-weight:bold">void</span><span style="margin:0px; padding:0px; border:none; background-color:inherit">)drawRect:(CGRect)rect&nbsp;{&nbsp;</span></span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;&nbsp;CGContextRef&nbsp;ctx&nbsp;=&nbsp;UIGraphicsGetCurrentContext();&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;&nbsp;CGContextSetStrokeColorWithColor(ctx,&nbsp;[UIColor&nbsp;blackColor].CGColor);&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;&nbsp;CGContextSetLineWidth(ctx,&nbsp;3);&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;&nbsp;UIBezierPath&nbsp;*path;&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;&nbsp;path&nbsp;=&nbsp;[UIBezierPath&nbsp;bezierPathWithRoundedRect:CGRectMake(100,&nbsp;100,&nbsp;100,&nbsp;100)&nbsp;byRoundingCorners:(UIRectCornerTopLeft&nbsp;|UIRectCornerTopRight)&nbsp;cornerRadii:CGSizeMake(10,&nbsp;10)];&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;&nbsp;[path&nbsp;stroke];&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">}&nbsp;</span></li></ol></pre>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px; text-align:center">
<img src="http://www.cocoachina.com/cms/uploads/allimg/140115/4196_140115115025_1.png" width="205" border="0" height="190" alt="" style="border:0px; max-width:700px; margin:10px 0px"></div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px; text-align:center">
图7 左右圆角矩形</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
<strong>裁剪</strong></div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
路径的另一用处是遮蔽区域，以防对遮蔽区域进一步绘图。这种用法被称为裁剪。裁剪区域外的图形不会被绘制到。默认情况下，一个图形上下文的裁剪区域是整个图形上下文。你可在上下文中的任何地方绘图。</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
总的来说，裁剪区域是上下文的一个特性。与已存在的裁剪区域相交会出现新的裁剪区域。所以如果你应用了你自己的裁剪区域，稍后将它从图形上下文中移除的做法是使用CGContextSaveGState和CGContextRestoreGState函数将代码包装起来。</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
为了便于说明这一点，我使用裁剪而不是使用混合模式在箭头杆子上打孔的方法重写了生成箭头的代码。这样做有点小复杂，因为我们想要裁剪区域不在三角形内而在三角形外部。为了表明这一点，我们使用了一个三角形和一个矩形组成了一个组合路径。</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
当填充一个组合路径并使用它表示一个裁剪区域时，系统遵循以下两规则之一：</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
<span style="color:rgb(128,0,0)">环绕规则（Winding rule）</span></div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
如果边界是顺时针绘制，那么在其内部逆时针绘制的边界所包含的内容为空。如果边界是逆时针绘制，那么在其内部顺时针绘制的边界所包含的内容为空。</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
<span style="color:rgb(128,0,0)">奇偶规则</span></div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
最外层的边界代表内部都有效，都要填充；之后向内第二个边界代表它的内部无效，不需填充；如此规则继续向内寻找边界线。我们的情况非常简单，所以使用奇偶规则就很容易了。这里我们使用CGContextEOCllip设置裁剪区域然后进行绘图。（如果不是很明白，可以参见这篇文章：<span style="color:rgb(0,0,255)"><a target="_blank" href="http://disanji.net/2010/12/05/5-ways-to-draw-2d-shape-with-hole-in-html/" target="_blank" style="font-size:12px; line-height:normal; text-decoration:none; color:rgb(102,102,102)"><span style="color:rgb(0,0,255)">五种方法绘制有孔的2d形状</span></a></span>）</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<pre style="margin-top:0px; margin-bottom:1em; padding:0px; font-family:'Courier New',monospace; width:662.296875px; overflow:auto; background-color:rgb(247,247,247); color:rgb(51,51,51)"><ol class="dp-c" style="padding:5px 0px; list-style-position:initial; border-style:none none none solid; border-left-width:3px; border-left-color:rgb(20,107,0); color:rgb(92,92,92); margin:0px 0px 1px 3em!important"><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGContextRef&nbsp;con&nbsp;=&nbsp;UIGraphicsGetCurrentContext();&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit"><span class="comment" style="margin:0px; padding:0px; border:none; color:rgb(0,130,0); background-color:inherit">//&nbsp;在上下文裁剪区域中挖一个三角形状的孔</span><span style="margin:0px; padding:0px; border:none; background-color:inherit">&nbsp;</span></span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGContextMoveToPoint(con,&nbsp;90,&nbsp;100);&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGContextAddLineToPoint(con,&nbsp;100,&nbsp;90);&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGContextAddLineToPoint(con,&nbsp;110,&nbsp;100);&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGContextClosePath(con);&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGContextAddRect(con,&nbsp;CGContextGetClipBoundingBox(con));&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit"><span class="comment" style="margin:0px; padding:0px; border:none; color:rgb(0,130,0); background-color:inherit">//&nbsp;使用奇偶规则，裁剪区域为矩形减去三角形区域</span><span style="margin:0px; padding:0px; border:none; background-color:inherit">&nbsp;</span></span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGContextEOClip(con);&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit"><span class="comment" style="margin:0px; padding:0px; border:none; color:rgb(0,130,0); background-color:inherit">//&nbsp;绘制垂线</span><span style="margin:0px; padding:0px; border:none; background-color:inherit">&nbsp;</span></span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGContextMoveToPoint(con,&nbsp;100,&nbsp;100);&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGContextAddLineToPoint(con,&nbsp;100,&nbsp;19);&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGContextSetLineWidth(con,&nbsp;20);&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGContextStrokePath(con);&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit"><span class="comment" style="margin:0px; padding:0px; border:none; color:rgb(0,130,0); background-color:inherit">//&nbsp;画红色箭头</span><span style="margin:0px; padding:0px; border:none; background-color:inherit">&nbsp;</span></span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGContextSetFillColorWithColor(con,&nbsp;[[UIColor&nbsp;redColor]&nbsp;CGColor]);&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGContextMoveToPoint(con,&nbsp;80,&nbsp;25);&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGContextAddLineToPoint(con,&nbsp;100,&nbsp;0);&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGContextAddLineToPoint(con,&nbsp;120,&nbsp;25);&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGContextFillPath(con);&nbsp;&nbsp;</span></li></ol></pre>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
<strong>&nbsp;渐变</strong></div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
渐变可以很简单也可以很复杂。一个简单的渐变（接下来要讨论的）由一端点的颜色与另一端点的颜色决定，如果在中间点加入颜色（可选），那么渐变会在上下文的两个点之间线性的绘制或在上下文的两个圆之间放射状的绘制。不能使用渐变作为路径的填充色，但可使用裁剪限制对路径形状的渐变。</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
我重写了绘制箭头的代码，箭杆使用了线性渐变。效果如图7所示。</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px; text-align:center">
<img src="http://www.cocoachina.com/cms/uploads/allimg/140115/4196_140115115203_1.png" width="81" border="0" height="102" alt="" style="border:0px; max-width:700px; margin:10px 0px"></div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px; text-align:center">
图8 箭头杆子渐变</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<pre style="margin-top:0px; margin-bottom:1em; padding:0px; font-family:'Courier New',monospace; width:662.296875px; overflow:auto; background-color:rgb(247,247,247); color:rgb(51,51,51)"><ol class="dp-c" style="padding:5px 0px; list-style-position:initial; border-style:none none none solid; border-left-width:3px; border-left-color:rgb(20,107,0); color:rgb(92,92,92); margin:0px 0px 1px 3em!important"><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGContextRef&nbsp;con&nbsp;=&nbsp;UIGraphicsGetCurrentContext();&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGContextSaveGState(con);&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit"><span class="comment" style="margin:0px; padding:0px; border:none; color:rgb(0,130,0); background-color:inherit">//&nbsp;在上下文裁剪区域挖一个三角形孔</span><span style="margin:0px; padding:0px; border:none; background-color:inherit">&nbsp;</span></span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGContextMoveToPoint(con,&nbsp;90,&nbsp;100);&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGContextAddLineToPoint(con,&nbsp;100,&nbsp;90);&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGContextAddLineToPoint(con,&nbsp;110,&nbsp;100);&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGContextClosePath(con);&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGContextAddRect(con,&nbsp;CGContextGetClipBoundingBox(con));&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGContextEOClip(con);&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit"><span class="comment" style="margin:0px; padding:0px; border:none; color:rgb(0,130,0); background-color:inherit">//绘制一个垂线，让它的轮廓形状成为裁剪区域</span><span style="margin:0px; padding:0px; border:none; background-color:inherit">&nbsp;</span></span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGContextMoveToPoint(con,&nbsp;100,&nbsp;100);&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGContextAddLineToPoint(con,&nbsp;100,&nbsp;19);&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGContextSetLineWidth(con,&nbsp;20);&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit"><span class="comment" style="margin:0px; padding:0px; border:none; color:rgb(0,130,0); background-color:inherit">//&nbsp;使用路径的描边版本替换图形上下文的路径</span><span style="margin:0px; padding:0px; border:none; background-color:inherit">&nbsp;</span></span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGContextReplacePathWithStrokedPath(con);&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit"><span class="comment" style="margin:0px; padding:0px; border:none; color:rgb(0,130,0); background-color:inherit">//&nbsp;对路径的描边版本实施裁剪</span><span style="margin:0px; padding:0px; border:none; background-color:inherit">&nbsp;</span></span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGContextClip(con);&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit"><span class="comment" style="margin:0px; padding:0px; border:none; color:rgb(0,130,0); background-color:inherit">//&nbsp;绘制渐变</span><span style="margin:0px; padding:0px; border:none; background-color:inherit">&nbsp;</span></span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGFloat&nbsp;locs[3]&nbsp;=&nbsp;{&nbsp;0.0,&nbsp;0.5,&nbsp;1.0&nbsp;};&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGFloat&nbsp;colors[12]&nbsp;=&nbsp;{&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">0.3,0.3,0.3,0.8,&nbsp;<span class="comment" style="margin:0px; padding:0px; border:none; color:rgb(0,130,0); background-color:inherit">//&nbsp;开始颜色，透明灰</span><span style="margin:0px; padding:0px; border:none; background-color:inherit">&nbsp;</span></span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">0.0,0.0,0.0,1.0,&nbsp;<span class="comment" style="margin:0px; padding:0px; border:none; color:rgb(0,130,0); background-color:inherit">//&nbsp;中间颜色，黑色</span><span style="margin:0px; padding:0px; border:none; background-color:inherit">&nbsp;</span></span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">0.3,0.3,0.3,0.8&nbsp;<span class="comment" style="margin:0px; padding:0px; border:none; color:rgb(0,130,0); background-color:inherit">//&nbsp;末尾颜色，透明灰</span><span style="margin:0px; padding:0px; border:none; background-color:inherit">&nbsp;</span></span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">};&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGColorSpaceRef&nbsp;sp&nbsp;=&nbsp;CGColorSpaceCreateDeviceGray();&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGGradientRef&nbsp;grad&nbsp;=&nbsp;CGGradientCreateWithColorComponents&nbsp;(sp,&nbsp;colors,&nbsp;locs,&nbsp;3);&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGContextDrawLinearGradient(con,&nbsp;grad,&nbsp;CGPointMake(89,0),&nbsp;CGPointMake(111,0),&nbsp;0);&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGColorSpaceRelease(sp);&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGGradientRelease(grad);&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGContextRestoreGState(con);&nbsp;<span class="comment" style="margin:0px; padding:0px; border:none; color:rgb(0,130,0); background-color:inherit">//&nbsp;完成裁剪</span><span style="margin:0px; padding:0px; border:none; background-color:inherit">&nbsp;</span></span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit"><span class="comment" style="margin:0px; padding:0px; border:none; color:rgb(0,130,0); background-color:inherit">//&nbsp;绘制红色箭头</span><span style="margin:0px; padding:0px; border:none; background-color:inherit">&nbsp;</span></span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGContextSetFillColorWithColor(con,&nbsp;[[UIColor&nbsp;redColor]&nbsp;CGColor]);&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGContextMoveToPoint(con,&nbsp;80,&nbsp;25);&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGContextAddLineToPoint(con,&nbsp;100,&nbsp;0);&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGContextAddLineToPoint(con,&nbsp;120,&nbsp;25);&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGContextFillPath(con);&nbsp;</span></li></ol></pre>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
调用CGContextReplacePathWithStrokedPath函数假装对当前路径描边，并使用当前线段宽度和与线段相关的上下文状态设置。但接着创建的是描边路径外部的一个新的路径。因此，相对于使用粗的线条，我们使用了一个矩形区域作为裁剪区域。</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
虽然过程比较冗长但是非常的简单；我们将渐变描述为一组在一端点（0.0）和另一端点（1.0）之间连续区上的位置，以及设置与每个位置相对应的颜色。为了提亮边缘的渐变，加深中间的渐变，我使用了三个位置，黑色点的位置是0.5。为了创建渐变，还需要提供一个颜色空间。最后，我创建出了该渐变，并对裁剪区域绘制线性渐变，最后释放了颜色空间和渐变。</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
<strong>颜色与模板</strong></div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
在iOS中，CGColor表示颜色（具体类型为CGColorRef）。使用UIColor的colorWithCGColor：和CGColor方法可bridged cast到UIColor。</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
在iOS中，模板表示为CGPattern（具体类型为CGPatternRef）。你可以创建一个模板并使用它进行描边或填充。其过程是相当复杂的。作为一个非常简单的例子，我将使用红蓝相间的三角形替换箭头的三角形部分。现在移除下面行：</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
CGContextSetFillColorWithColor（con， [UIColor redColor].CGColor））；</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
在被移除的地方填入下面代码：</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<pre style="margin-top:0px; margin-bottom:1em; padding:0px; font-family:'Courier New',monospace; width:662.296875px; overflow:auto; background-color:rgb(247,247,247); color:rgb(51,51,51)"><ol class="dp-c" style="padding:5px 0px; list-style-position:initial; border-style:none none none solid; border-left-width:3px; border-left-color:rgb(20,107,0); color:rgb(92,92,92); margin:0px 0px 1px 3em!important"><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGColorSpaceRef&nbsp;sp2&nbsp;=&nbsp;CGColorSpaceCreatePattern(NULL);&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGContextSetFillColorSpace&nbsp;(con,&nbsp;sp2);&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGColorSpaceRelease&nbsp;(sp2);&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGPatternCallbacks&nbsp;callback&nbsp;=&nbsp;{0,&nbsp;&amp;drawStripes,&nbsp;NULL&nbsp;};&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGAffineTransform&nbsp;tr&nbsp;=&nbsp;CGAffineTransformIdentity;&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGPatternRef&nbsp;patt&nbsp;=&nbsp;CGPatternCreate(NULL,CGRectMake(0,0,4,4),&nbsp;tr,&nbsp;4,&nbsp;4,&nbsp;kCGPatternTilingConstantSpacingMinimalDistortion,&nbsp;<span class="keyword" style="margin:0px; padding:0px; border:none; color:rgb(0,102,153); background-color:inherit; font-weight:bold">true</span><span style="margin:0px; padding:0px; border:none; background-color:inherit">,&nbsp;&amp;callback);&nbsp;</span></span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGFloat&nbsp;alph&nbsp;=&nbsp;1.0;&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGContextSetFillPattern(con,&nbsp;patt,&nbsp;&amp;alph);&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGPatternRelease(patt);&nbsp;</span></li></ol></pre>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
代码非常冗长，但它却是一个完整的样板。现在我们从后往前分析代码: 我们调用CGContextSetFillPattern不是设置填充颜色，我们设置的是填充的模板。函数的第三个参数是一个指向CGFloat的指针，所以我们事先设置CGFloat自身。第二个参数是一个CGPatternRef对象，所以我们需要事先创建CGPatternRef，并在最后释放它。</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
现在开始讨论CGPatternCreate。一个模板是在一个矩形元中的绘图。我们需要矩形元的尺寸（第二个参数）以及矩形元原始点之间的间隙（第四和第五个参数）。这这种情况下，矩形元是4*4的，每一个矩形元与它的周围矩形元是紧密贴合的。我们需要提供一个应用到矩形元的变换参数（第三个参数）；在这种情况下，我们不需要变换做什么工作，所以我们应用了一个恒等变换。我们应用了一个瓷砖规则（第六个参数）。我们需要声明的是颜色模板不是漏印（stencil）模板，所以参数&#20540;为true。并且我们需要提供一个指向回调函数的指针，回调函数的工作是向矩形元绘制模板。第八个参数是一个指向CGPatternCallbacks结构体的指针。这个结构体由数字0和两个指向函数的指针构成。第一个函数指针指向的函数当模板被绘制到矩形元中被调用，第二个函数指针指向的函数当模板被释放后调用。第二个函数指针我们没有指定，它的存在主要是为了内存管理的需要。但在这个简单的例子中，我们并不需要。</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
在你使用颜色模板调用CGContextSetFillPattern函数之前，你需要设置将应用到模板颜色空间的上下文填充颜色空间。如果你忽略这项工作，那么当你调用CGContextSetFillPattern函数时会发生错误。所以我们创建了颜色空间，设置它作为上下文的填充颜色空间，并在后面做了释放。</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
到这里我们仍然没有完成绘图。因为我还没有编写向矩形元中绘图的函数！绘图函数地址被表示为&amp;drawStripes。绘图代码如下所示：</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<pre style="margin-top:0px; margin-bottom:1em; padding:0px; font-family:'Courier New',monospace; width:662.296875px; overflow:auto; background-color:rgb(247,247,247); color:rgb(51,51,51)"><ol class="dp-c" style="padding:5px 0px; list-style-position:initial; border-style:none none none solid; border-left-width:3px; border-left-color:rgb(20,107,0); color:rgb(92,92,92); margin:0px 0px 1px 3em!important"><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit"><span class="keyword" style="margin:0px; padding:0px; border:none; color:rgb(0,102,153); background-color:inherit; font-weight:bold">void</span><span style="margin:0px; padding:0px; border:none; background-color:inherit">&nbsp;drawStripes&nbsp;(</span><span class="keyword" style="margin:0px; padding:0px; border:none; color:rgb(0,102,153); background-color:inherit; font-weight:bold">void</span><span style="margin:0px; padding:0px; border:none; background-color:inherit">&nbsp;*info,&nbsp;CGContextRef&nbsp;con)&nbsp;{&nbsp;</span></span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit"><span class="comment" style="margin:0px; padding:0px; border:none; color:rgb(0,130,0); background-color:inherit">//&nbsp;assume&nbsp;4&nbsp;x&nbsp;4&nbsp;cell</span><span style="margin:0px; padding:0px; border:none; background-color:inherit">&nbsp;</span></span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGContextSetFillColorWithColor(con,&nbsp;[[UIColor&nbsp;redColor]&nbsp;CGColor]);&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGContextFillRect(con,&nbsp;CGRectMake(0,0,4,4));&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGContextSetFillColorWithColor(con,&nbsp;[[UIColor&nbsp;blueColor]&nbsp;CGColor]);&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGContextFillRect(con,&nbsp;CGRectMake(0,0,4,2));&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">}&nbsp;</span></li></ol></pre>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px; text-align:center">
<img src="http://www.cocoachina.com/cms/uploads/allimg/140115/4196_140115115344_1.png" width="94" border="0" height="102" alt="" style="border:0px; max-width:700px; margin:10px 0px"></div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px; text-align:center">
图9 模板填充</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
如你所见，实际的模板绘图代码是非常简单的。唯一的复杂点在于CGPatternCreate函数必须与模板绘图函数的矩形元尺寸相同。我们知道矩形元的尺寸为4*4，所以我们用红色填充它，并接着填充它的下半部分为绿色。当这些矩形元被水平垂直平铺时，我们得到了如图8所示的条纹图案。</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
注意，最后图形上下文遗留下了一个不可取的状态，即填充颜色空间被设置为了一个模板颜色空间。如果稍后尝试设置填充颜色为常规颜色，就会引起错误。通常的解决方案是，使用CGContextSaveGState和CGContextRestoreGState函数将代码包起来。</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
你可能观察到图8的平铺效果并不与箭头的三角形内部相符合：最底部的&#20284;乎只平铺了一半蓝色。这是因为一个模板的定位并不关心你填充（描边）的形状，总的来说它只关心图形上下文。我们可以调用CGContextSetPatternPhase函数改变模板的定位。</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
<strong>图形上下文变换</strong></div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
就像UIView可以实现变换，同样图形上下文也具备这项功能。然而对图形上下文应用一个变换操作不会对已在图形上下文上的绘图产生什么影响，它只会影响到在上下文变换之后被绘制的图形，并改变被映射到图形上下文区域的坐标方式。一个图形上下文变换被称为CTM，意为“当前变换矩阵“（current transformation matrix）。</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
完全利用图形上下文的CTM来免于即使是简单的计算操作是很常见的。你可以使用CGContextConcatCTM函数将当前变换乘上任何CGAffineTransform，还有一些便利函数可对当前变换应用平移、缩放，旋转变换。</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
当你获得上下文的时候，对图形上下文的基本变换已经设置好了；这就是系统能映射上下文绘图坐标到屏幕坐标的原因。无论你对当前变换应用了什么变换，基本变换变换依然有效并且绘图继续工作。通过将你的变换代码封装到CGContextSaveGState和CGContextRestoreGState函数调用中，对基本变换应用的变换操作可以被还原。</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
举个例子，对于我们迄今为止使用代码绘制的向上箭头来说，已知的放置箭头的方式仅仅只有一个位置：箭头矩形框的左上角被硬编码在坐标{80，0}。这样代码很难理解、灵活性差、且很难被重用。最明智的做法是通过将所有代码中的x坐标&#20540;减去80，让箭头矩形框左上角在坐标{0，0}。事先应用一个简单的平移变换，很容易将箭头画在任何位置。为了映射坐标到箭头的左上角，我们使用下面代码：</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
<span style="color:rgb(128,0,0)">CGContextTranslateCTM（con, 80, 0）; //在坐标{0,0}处绘制箭头</span></div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
旋转变换特别的有用，它可以让你在一个被旋转的方向上进行绘制而无需使用任何复杂的三角函数。然而这略有点复杂，因为旋转变换围绕的点是原点坐标。这几乎不是你所想要的，所以你先是应用了一个平移变换，为的是映射原点到你真正想绕其旋转的点。但是接着，在旋转之后，为了算出你在哪里绘图，你可能需要做一次逆向平移变换。</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
为了说明这个做法，我将绕箭头杆子尾部旋转多个角度重复绘制箭头，并把对箭头的绘图封装为UIImage对象。接着我们简单重复绘制UIImage对象。</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
具体代码如下：</div>
<pre style="margin-top:0px; margin-bottom:1em; padding:0px; font-family:'Courier New',monospace; width:662.296875px; overflow:auto; background-color:rgb(247,247,247); color:rgb(51,51,51)"><ol class="dp-c" style="padding:5px 0px; list-style-position:initial; border-style:none none none solid; border-left-width:3px; border-left-color:rgb(20,107,0); color:rgb(92,92,92); margin:0px 0px 1px 3em!important"><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit"><span style="margin:0px; padding:0px; border:none; background-color:inherit">-&nbsp;(</span><span class="keyword" style="margin:0px; padding:0px; border:none; color:rgb(0,102,153); background-color:inherit; font-weight:bold">void</span><span style="margin:0px; padding:0px; border:none; background-color:inherit">)drawRect:(CGRect)rect&nbsp;{&nbsp;&nbsp;</span></span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">UIGraphicsBeginImageContextWithOptions(CGSizeMake(40,100),&nbsp;NO,&nbsp;0.0);&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGContextRef&nbsp;con&nbsp;=&nbsp;UIGraphicsGetCurrentContext();&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGContextSaveGState(con);&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGContextMoveToPoint(con,&nbsp;90&nbsp;-&nbsp;80,&nbsp;100);&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGContextAddLineToPoint(con,&nbsp;100&nbsp;-&nbsp;80,&nbsp;90);&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGContextAddLineToPoint(con,&nbsp;110&nbsp;-&nbsp;80,&nbsp;100);&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGContextMoveToPoint(con,&nbsp;110&nbsp;-&nbsp;80,&nbsp;100);&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGContextAddLineToPoint(con,&nbsp;100&nbsp;-&nbsp;80,&nbsp;90);&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGContextAddLineToPoint(con,&nbsp;90&nbsp;-&nbsp;80,&nbsp;100);&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGContextClosePath(con);&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGContextAddRect(con,&nbsp;CGContextGetClipBoundingBox(con));&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGContextEOClip(con);&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGContextMoveToPoint(con,&nbsp;100&nbsp;-&nbsp;80,&nbsp;100);&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGContextAddLineToPoint(con,&nbsp;100&nbsp;-&nbsp;80,&nbsp;19);&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGContextSetLineWidth(con,&nbsp;20);&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGContextReplacePathWithStrokedPath(con);&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGContextClip(con);&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGFloat&nbsp;locs[3]&nbsp;=&nbsp;{&nbsp;0.0,&nbsp;0.5,&nbsp;1.0&nbsp;};&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGFloat&nbsp;colors[12]&nbsp;=&nbsp;{&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">0.3,0.3,0.3,0.8,&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">0.0,0.0,0.0,1.0,&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">0.3,0.3,0.3,0.8&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">};&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGColorSpaceRef&nbsp;sp&nbsp;=&nbsp;CGColorSpaceCreateDeviceGray();&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGGradientRef&nbsp;grad&nbsp;=&nbsp;CGGradientCreateWithColorComponents&nbsp;(sp,&nbsp;colors,&nbsp;locs,&nbsp;3);&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGContextDrawLinearGradient&nbsp;(con,&nbsp;grad,&nbsp;CGPointMake(89&nbsp;-&nbsp;80,0),&nbsp;CGPointMake(111&nbsp;-&nbsp;80,0),&nbsp;0);&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGColorSpaceRelease(sp);&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGGradientRelease(grad);&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGContextRestoreGState(con);&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGColorSpaceRef&nbsp;sp2&nbsp;=&nbsp;CGColorSpaceCreatePattern(NULL);&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGContextSetFillColorSpace&nbsp;(con,&nbsp;sp2);&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGColorSpaceRelease&nbsp;(sp2);&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGPatternCallbacks&nbsp;callback&nbsp;=&nbsp;{0,&nbsp;&amp;drawStripes,&nbsp;NULL&nbsp;};&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGAffineTransform&nbsp;tr&nbsp;=&nbsp;CGAffineTransformIdentity;&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGPatternRef&nbsp;patt&nbsp;=&nbsp;CGPatternCreate(NULL,CGRectMake(0,0,4,4),tr,4,4，kCGPatternTilingConstantSpacingMinimalDistortion,<span class="keyword" style="margin:0px; padding:0px; border:none; color:rgb(0,102,153); background-color:inherit; font-weight:bold">true</span><span style="margin:0px; padding:0px; border:none; background-color:inherit">,&nbsp;&amp;callback);&nbsp;</span></span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGFloat&nbsp;alph&nbsp;=&nbsp;1.0;&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGContextSetFillPattern(con,&nbsp;patt,&nbsp;&amp;alph);&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGPatternRelease(patt);&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGContextMoveToPoint(con,&nbsp;80&nbsp;-&nbsp;80,&nbsp;25);&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGContextAddLineToPoint(con,&nbsp;100&nbsp;-&nbsp;80,&nbsp;0);&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGContextAddLineToPoint(con,&nbsp;120&nbsp;-&nbsp;80,&nbsp;25);&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGContextFillPath(con);&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">UIImage*&nbsp;im&nbsp;=&nbsp;UIGraphicsGetImageFromCurrentImageContext();&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">UIGraphicsEndImageContext();&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">con&nbsp;=&nbsp;UIGraphicsGetCurrentContext();&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">[im&nbsp;drawAtPoint:CGPointMake(0,0)];&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit"><span class="keyword" style="margin:0px; padding:0px; border:none; color:rgb(0,102,153); background-color:inherit; font-weight:bold">for</span><span style="margin:0px; padding:0px; border:none; background-color:inherit">&nbsp;(</span><span class="keyword" style="margin:0px; padding:0px; border:none; color:rgb(0,102,153); background-color:inherit; font-weight:bold">int</span><span style="margin:0px; padding:0px; border:none; background-color:inherit">&nbsp;i=0;&nbsp;i&lt;3;&nbsp;i&#43;&#43;)&nbsp;{&nbsp;</span></span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGContextTranslateCTM(con,&nbsp;20,&nbsp;100);&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGContextRotateCTM(con,&nbsp;30&nbsp;*&nbsp;M_PI/180.0);&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGContextTranslateCTM(con,&nbsp;-20,&nbsp;-100);&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">[im&nbsp;drawAtPoint:CGPointMake(0,0)];&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">}&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">}&nbsp;</span></li></ol>
</pre>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px; text-align:center">
<img src="http://www.cocoachina.com/cms/uploads/allimg/140115/4196_140115115447_1.png" width="163" border="0" height="119" alt="" style="border:0px; max-width:700px; margin:10px 0px"></div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px; text-align:center">
图10 使用CTM旋转变换</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
变换有多个方法解决我们早期使用CGContextDrawImage函数遇到的倒置问题。相对于逆向绘图，我们选择逆向我们绘图的上下文。实质上，我们对上下文坐标系统应用了一个“倒置”变换。你自上而下移动上下文，接着你通过应用一个让y坐标乘以-1的缩放变换逆向y坐标的方向。</div>
<pre style="margin-top:0px; margin-bottom:1em; padding:0px; font-family:'Courier New',monospace; width:662.296875px; overflow:auto; background-color:rgb(247,247,247); color:rgb(51,51,51)"><ol class="dp-c" style="padding:5px 0px; list-style-position:initial; border-style:none none none solid; border-left-width:3px; border-left-color:rgb(20,107,0); color:rgb(92,92,92); margin:0px 0px 1px 3em!important"><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGContextTranslateCTM(con,&nbsp;0,&nbsp;theHeight);&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGContextScaleCTM(con,&nbsp;1.0,&nbsp;-1.0);&nbsp;</span></li></ol></pre>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
上下文的顶部应该被你往下移动多远依赖于你绘制的图片。比如说我们可以绘制没有倒置问题的两个半边的火星图形（前面讨论的一个例子）。</div>
<pre style="margin-top:0px; margin-bottom:1em; padding:0px; font-family:'Courier New',monospace; width:662.296875px; overflow:auto; background-color:rgb(247,247,247); color:rgb(51,51,51)"><ol class="dp-c" style="padding:5px 0px; list-style-position:initial; border-style:none none none solid; border-left-width:3px; border-left-color:rgb(20,107,0); color:rgb(92,92,92); margin:0px 0px 1px 3em!important"><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit"><span style="margin:0px; padding:0px; border:none; background-color:inherit">CGContextTranslateCTM(con,&nbsp;0,&nbsp;sz.height);&nbsp;</span><span class="comment" style="margin:0px; padding:0px; border:none; color:rgb(0,130,0); background-color:inherit">//&nbsp;sz为[mars&nbsp;size]</span><span style="margin:0px; padding:0px; border:none; background-color:inherit">&nbsp;</span></span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGContextScaleCTM(con,&nbsp;1.0,&nbsp;-1.0);&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGContextDrawImage(con,&nbsp;CGRectMake(0,&nbsp;0,&nbsp;sz.width/2.0,&nbsp;sz.height),&nbsp;marsLeft);&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGContextDrawImage(con,&nbsp;CGRectMake(b.size.width-sz.width/2.0,&nbsp;0,&nbsp;sz.width/2.0,&nbsp;sz.height),marsRight);&nbsp;</span></li></ol></pre>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
<strong>阴影</strong></div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
为了在绘图上加入阴影，可在绘图之前设置上下文的阴影&#20540;。阴影的位置表示为CGSize，如果CGSize的两个&#20540;都是正数，则表示阴影是朝下和朝右的。模糊度被表示为任何一个正数。苹果没有解释缩放的工作方式，但实验表明12是最佳的模糊度，99及以上的模糊度会让阴影变得不成形。</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
我在图9的基础上给上下文加了一个阴影：</div>
<pre style="margin-top:0px; margin-bottom:1em; padding:0px; font-family:'Courier New',monospace; width:662.296875px; overflow:auto; background-color:rgb(247,247,247); color:rgb(51,51,51)"><ol class="dp-c" style="padding:5px 0px; list-style-position:initial; border-style:none none none solid; border-left-width:3px; border-left-color:rgb(20,107,0); color:rgb(92,92,92); margin:0px 0px 1px 3em!important"><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">con&nbsp;=&nbsp;UIGraphicsGetCurrentContext();&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGContextSetShadow(con,&nbsp;CGSizeMake(7,&nbsp;7),&nbsp;12);&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">[im&nbsp;drawAtPoint:CGPointMake(0,0)];&nbsp;</span></li></ol></pre>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
然而，使用这种方法有一个不太明显的问题。我们是在每绘制一个箭头的时候加上的阴影。因此，箭头的阴影会投射在另一个箭头上面。我们想要的是让所有的箭头集体地投射出一个阴影。解决方法是使用一个透明的图层；该图层类&#20284;一个先是叠加所有绘图然后加上阴影的一个子上下文。代码如下：</div>
<pre style="margin-top:0px; margin-bottom:1em; padding:0px; font-family:'Courier New',monospace; width:662.296875px; overflow:auto; background-color:rgb(247,247,247); color:rgb(51,51,51)"><ol class="dp-c" style="padding:5px 0px; list-style-position:initial; border-style:none none none solid; border-left-width:3px; border-left-color:rgb(20,107,0); color:rgb(92,92,92); margin:0px 0px 1px 3em!important"><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">con&nbsp;=&nbsp;UIGraphicsGetCurrentContext();&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGContextSetShadow(con,&nbsp;CGSizeMake(7,&nbsp;7),&nbsp;12);&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGContextBeginTransparencyLayer(con,&nbsp;NULL);&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">[im&nbsp;drawAtPoint:CGPointMake(0,0)];&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit"><span class="keyword" style="margin:0px; padding:0px; border:none; color:rgb(0,102,153); background-color:inherit; font-weight:bold">for</span><span style="margin:0px; padding:0px; border:none; background-color:inherit">&nbsp;(</span><span class="keyword" style="margin:0px; padding:0px; border:none; color:rgb(0,102,153); background-color:inherit; font-weight:bold">int</span><span style="margin:0px; padding:0px; border:none; background-color:inherit">&nbsp;i=0;&nbsp;i&lt;3;&nbsp;i&#43;&#43;)&nbsp;{&nbsp;</span></span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGContextTranslateCTM(con,&nbsp;20,&nbsp;100);&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGContextRotateCTM(con,&nbsp;30&nbsp;*&nbsp;M_PI/180.0);&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGContextTranslateCTM(con,&nbsp;-20,&nbsp;-100);&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">[im&nbsp;drawAtPoint:CGPointMake(0,0)];&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">}&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit"><span class="comment" style="margin:0px; padding:0px; border:none; color:rgb(0,130,0); background-color:inherit">//&nbsp;在调用了CGContextEndTransparencyLayer函数之后，</span><span style="margin:0px; padding:0px; border:none; background-color:inherit">&nbsp;</span></span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit"><span class="comment" style="margin:0px; padding:0px; border:none; color:rgb(0,130,0); background-color:inherit">//&nbsp;图层内容会在应用全局alpha和上下文阴影状态之后被合成到上下文中</span><span style="margin:0px; padding:0px; border:none; background-color:inherit">&nbsp;</span></span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGContextEndTransparencyLayer(con);&nbsp;</span></li></ol></pre>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px; text-align:center">
<img src="http://www.cocoachina.com/cms/uploads/allimg/140115/4196_140115115645_1.png" width="136" border="0" height="121" alt="" style="border:0px; max-width:700px; margin:10px 0px"></div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px; text-align:center">
图11 阴影效果</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
<strong>点与像素</strong></div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
一个点是由xy坐标描述的一个无穷小量的位置。通过指定点实现在图形上下文中的绘图。我们并没有关心设备的分辨率，因为Core Graphics已经精细地将绘图映射到物理输出设备（基于CTM、反锯齿和平滑技术）。因此，文章之前的讨论只关心图形上下文的点，不关注点与屏幕像素的关系。</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
然而像素是真实存在的。一个像素是真实世界中一个具有完整物理尺寸的显示单元。整数的点实际上介于像素之间。在单分辨率设备上，这可能会让人感到迷惑。比方说，如果使用线宽为1的线条对一个整数坐标的垂直路径描边，那么线条将会被分为两半，分别落在路径的两侧。所以在单分辨率设备上线宽会变成2px（因为设备无法表示半个像素）。</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px; text-align:center">
<img src="http://www.cocoachina.com/cms/uploads/allimg/140115/4196_140115115714_1.png" width="609" border="0" height="262" alt="" style="border:0px; max-width:700px; margin:10px 0px"></div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px; text-align:center">
图12 整数的点坐标与偏移0.5点的坐标对应的描边处理</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
当你遇到显示效果不佳的时，可能会被建议通过对坐标增减0.5让它在像素中居中。这个建议可能有效，如图11。但它只是做了一些头脑简单的假设。一个复杂的做法是获得UIView的contentScaleFactor属性。这个&#20540;为1.0或2.0，所以你可以除以这个属性&#20540;得到从像素到点的转换。还可以想想用最精确的方式绘制一条水平或垂直的线条的方式不是描边路径，而是填充路径。使用这种方法UIView的子类代码将可以在任何设备上绘制一条完美的1px宽的垂线，代码如下：</div>
<pre style="margin-top:0px; margin-bottom:1em; padding:0px; font-family:'Courier New',monospace; width:662.296875px; overflow:auto; background-color:rgb(247,247,247); color:rgb(51,51,51)"><ol class="dp-c" style="padding:5px 0px; list-style-position:initial; border-style:none none none solid; border-left-width:3px; border-left-color:rgb(20,107,0); color:rgb(92,92,92); margin:0px 0px 1px 3em!important"><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">CGContextFillRect(con,&nbsp;CGRectMake(100,0,1.0/self.contentScaleFactor,100));&nbsp;</span></li></ol></pre>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
<strong>内容模式</strong></div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
一个视图向它自身绘图，相对于只有背景颜色和子视图，它还有内容。这意味着每当视图被调整大小它的contentMode属性就变得非常重要。正如我之前提到的，绘图系统会尽可能避免重头开始绘制视图。相反，绘图系统将使用之前绘图操作的缓存结果（位图回填）。所以，如果视图被重新调整大小，系统可能简单的伸缩或重定位缓存绘图，前提是你的contentMode设置指令是是这样设置的。</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
说明这一点略有点复杂。因为我需要安排调整视图大小而不引起重绘操作（调用drawRect：方法）。当程序启动时，我将创建一个MyView实例，并将它放在window上。接着将执行调整MyView尺寸的操作延迟到window出现和界面初次显示之后：</div>
<pre style="margin-top:0px; margin-bottom:1em; padding:0px; font-family:'Courier New',monospace; width:662.296875px; overflow:auto; background-color:rgb(247,247,247); color:rgb(51,51,51)"><ol class="dp-c" style="padding:5px 0px; list-style-position:initial; border-style:none none none solid; border-left-width:3px; border-left-color:rgb(20,107,0); color:rgb(92,92,92); margin:0px 0px 1px 3em!important"><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">-&nbsp;(BOOL)application:(UIApplication&nbsp;*)application&nbsp;didFinishLaunchingWithOptions:(NSDictionary&nbsp;*)launchOptions&nbsp;{&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;&nbsp;self.window&nbsp;=&nbsp;[[UIWindow&nbsp;alloc]&nbsp;initWithFrame:[[UIScreen&nbsp;mainScreen]&nbsp;bounds]];&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;&nbsp;self.window.rootViewController&nbsp;=&nbsp;[UIViewController&nbsp;<span class="keyword" style="margin:0px; padding:0px; border:none; color:rgb(0,102,153); background-color:inherit; font-weight:bold">new</span><span style="margin:0px; padding:0px; border:none; background-color:inherit">];&nbsp;</span></span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;&nbsp;MyView*&nbsp;mv&nbsp;=[[MyView&nbsp;alloc]&nbsp;initWithFrame:CGRectMake(0,&nbsp;0,&nbsp;self.window.bounds.size.width&nbsp;-&nbsp;50,&nbsp;150)];&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;&nbsp;mv.center&nbsp;=&nbsp;self.window.center;&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;&nbsp;[self.window.rootViewController.view&nbsp;addSubview:&nbsp;mv];&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;&nbsp;mv.opaque&nbsp;=&nbsp;NO;&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;&nbsp;mv.tag&nbsp;=&nbsp;111;&nbsp;<span class="comment" style="margin:0px; padding:0px; border:none; color:rgb(0,130,0); background-color:inherit">//&nbsp;so&nbsp;I&nbsp;can&nbsp;get&nbsp;a&nbsp;reference&nbsp;to&nbsp;this&nbsp;view&nbsp;later</span><span style="margin:0px; padding:0px; border:none; background-color:inherit">&nbsp;</span></span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;&nbsp;[self&nbsp;performSelector:@selector(resize:)&nbsp;withObject:nil&nbsp;afterDelay:0.1];&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;&nbsp;self.window.backgroundColor&nbsp;=&nbsp;[UIColor&nbsp;whiteColor];&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;&nbsp;[self.window&nbsp;makeKeyAndVisible];&nbsp;</span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;&nbsp;<span class="keyword" style="margin:0px; padding:0px; border:none; color:rgb(0,102,153); background-color:inherit; font-weight:bold">return</span><span style="margin:0px; padding:0px; border:none; background-color:inherit">&nbsp;YES;&nbsp;</span></span></li><li style="border:none; list-style:decimal-leading-zero outside; line-height:1.3em; margin:0px!important; padding:0px 3px 0px 10px!important"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">&nbsp;</span></li><li class="alt" style="margin:0px!important; padding:0px 3px 0px 10px!important; border:none; list-style:decimal-leading-zero outside; color:inherit; line-height:1.3em"><span style="margin:0px; padding:0px; border:none; color:black; background-color:inherit">}&nbsp;</span></li></ol></pre>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
我们将视图的高度调成之前的2倍。没有触发drawRect：方法的调用。如果我们视图的drawRect：方法代码和生成图9的代码相同，则我们得到如图12的结果，视图被显示在正确高度上。</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px; text-align:center">
<img src="http://www.cocoachina.com/cms/uploads/allimg/140115/4196_140115115818_1.png" width="188" border="0" height="311" alt="" style="border:0px; max-width:700px; margin:10px 0px"></div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px; text-align:center">
图13 内容自动伸展</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
可是早晚drawRect：方法会被调用，绘图将按照drawRect：方法中的代码被刷新。代码不会将箭头绘制在相对于视图边界的高度。它是在一个固定的高度。因此箭头会伸展，而且会在以后某个时间返回到原始的尺寸。</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
通常我们的视图的contentMode属性需要与视图绘制自己的方式一致。假设我们的drawRect：方法中的代码让箭头的尺寸和位置相对于视图的边界原点，即它的左上方。所以我们可以设置它的contentMode为UIViewContentModeTopLeft。又或者，我们可以将contentMode设置为UIVIewContentModeRedraw，这将引起缓存内容的自动缩放和重定位被关闭，最终结果是视图的setNeedsDisplay方法将被调用，触发drawRect：方法重绘视图内容。</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
在另一方面，如果一个视图只是暂时被调整大小。假设是作为动画的一部分，那么伸缩行为正是你所想要的。假设我们的动画是想要让视图变大然后还原回原始大小以达到作为吸引用户的一种手段。这就需要视图伸缩的时候视图的内容也跟着伸缩，正确的contentMode的&#20540;是UIViewContentModeScaleToFill，被伸缩的内容仅仅是视图内容的一副缓存图片，所以它运行起来十分的高效。</div>
<div style="margin:0px; padding:0px; color:rgb(51,51,51); font-family:'Helvetica Neue',Helvetica,STheiti,微软雅黑,黑体,Arial,Tahoma,sans-serif,serif; font-size:14px; line-height:25.200000762939453px">
&nbsp;</div>
   
</div>




<!-- Baidu Button BEGIN -->




<div class="bdsharebuttonbox tracking-ad" style="float: right;" data-mod="popu_172">
<a href="#" class="bds_more" data-cmd="more" style="background-position:0 0 !important; background-image: url(http://bdimg.share.baidu.com/static/api/img/share/icons_0_16.png?v=d754dcc0.png) !important"></a>
<a href="#" class="bds_qzone" data-cmd="qzone" title="分享到QQ空间"  style="background-position:0 -52px !important"></a>
<a href="#" class="bds_tsina" data-cmd="tsina" title="分享到新浪微博"style="background-position:0 -104px !important"></a>
<a href="#" class="bds_tqq" data-cmd="tqq" title="分享到腾讯微博"style="background-position:0 -260px !important"></a>
<a href="#" class="bds_renren" data-cmd="renren" title="分享到人人网"style="background-position:0 -208px !important"></a>
<a href="#" class="bds_weixin" data-cmd="weixin" title="分享到微信"style="background-position:0 -1612px !important" ></a>
</div>
<script>window._bd_share_config = { "common": { "bdSnsKey": {}, "bdText": "", "bdMini": "1", "bdMiniList": false, "bdPic": "", "bdStyle": "0", "bdSize": "16" }, "share": {} }; with (document) 0[(getElementsByTagName('head')[0] || body).appendChild(createElement('script')).src = 'http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion=' + ~(-new Date() / 36e5)];</script>
<!-- Baidu Button END -->

   <link rel="stylesheet" href="http://static.blog.csdn.net/css/blog_detail.css" />

    
<!--172.16.140.12-->

<!-- Baidu Button BEGIN -->
<script type="text/javascript" id="bdshare_js" data="type=tools&amp;uid=1536434" ></script>
<script type="text/javascript" id="bdshell_js"></script>
<script type="text/javascript">
    document.getElementById("bdshell_js").src = "http://bdimg.share.baidu.com/static/js/shell_v2.js?cdnversion=" + Math.ceil(new Date()/3600000)
</script>
<!-- Baidu Button END -->

 


        <div id="digg" ArticleId="19172947" >
            <dl id="btnDigg" class="digg digg_disable"  onclick="btndigga();">
               
                 <dt>顶</dt>
                <dd>1</dd>
            </dl>
           
              
            <dl id="btnBury" class="digg digg_disable"  onclick="btnburya();">
              
                  <dt>踩</dt>
                <dd>0</dd>               
            </dl>
            
        </div>
     <div class="tracking-ad" data-mod="popu_222"><a href="javascript:void(0);" >&nbsp;</a>   </div>
    <div class="tracking-ad" data-mod="popu_223"> <a href="javascript:void(0);" >&nbsp;</a></div>
    <script type="text/javascript">
                function btndigga() {
                    $(".tracking-ad[data-mod='popu_222'] a").click();
                }
                function btnburya() {
                    $(".tracking-ad[data-mod='popu_223'] a").click();
                }
            </script>

   <ul class="article_next_prev">
                <li class="prev_article"><span  onclick="_gaq.push(['_trackEvent','function', 'onclick', 'blog_articles_shangyipian']);location.href='/houwenfu/article/details/18706657';">上一篇</span><a href="/houwenfu/article/details/18706657" onclick="_gaq.push(['_trackEvent','function', 'onclick', 'blog_articles_shangyipian'])">iOS7中容易被忽视的新特性</a></li>
                <li class="next_article"><span onclick="_gaq.push(['_trackEvent','function', 'onclick', 'blog_articles_xiayipian']);location.href='/houwenfu/article/details/19286543';">下一篇</span><a href="/houwenfu/article/details/19286543" onclick="_gaq.push(['_trackEvent','function', 'onclick', 'blog_articles_xiayipian'])">MKNetworkKit: 网络处理又一利器</a></li>
    </ul>

    <div style="clear:both; height:10px;"></div>


        <div class="similar_article"  style="display:none">
                <h4>我的同类文章</h4>
                <div class="similar_c"style="margin:20px 0px 0px 0px">
                    <div class="similar_c_t">
                                <label class="similar_cur">
                                    <span  style="cursor:pointer"  onclick="GetCategoryArticles('1790805','u012858744','foot','19172947');">IOS开发<em>（61）</em></span>
                                </label>
                    </div>
                   
                    <div class="similar_wrap tracking-ad" data-mod="popu_141"  style="max-height:195px;">
                        <a href="http://blog.csdn.net" style="display:none">http://blog.csdn.net</a>
                        <ul class="similar_list fl">                          
                        </ul>

                        <ul class="similar_list fr">                           
                        </ul>
                    </div>
                </div>
            </div>    
    <script  type="text/javascript">
        $(function () {
            GetCategoryArticles('1790805', 'u012858744','foot','19172947');
        });
    </script>
      
</div>

     <div>
             <ins data-revive-zoneid="206" data-revive-id="8c38e720de1c90a6f6ff52f3f89c4d57"></ins> 
    </div>

<div id="suggest"></div>
         <script  language="javascript" type='text/javascript'>     
             $(function(){
                 $.get("/u012858744/svc/GetSuggestContent/19172947",function(data){
                     $("#suggest").html(data);
                 });     
             });             
         </script>  


<style>
.blog-ass-articl dd {
color: #369;
width: 99%; /*修改行*/
float: left;
overflow: hidden;
font: normal normal 12px/23px "SimSun";
height: 23px;
margin: 0;
padding: 0 0 0 10px;
margin-right: 30px;
background: url(http://static.blog.csdn.net/skin/default/images/blog-dot-red3.gif) no-repeat 0 10px;
}
</style>

 <link rel="stylesheet" href="http://static.blog.csdn.net/css/replace.css"/>
<div id="relate" data-mod="popu_218"  class="tracking-ad">
        <div class="relate_t">
            <h3><span>参考知识库</span></h3>
        </div>
        <div class="relate_c">
        </div>
</div>
 

<dl class="blog-ass-articl" id="res-relatived" > 
    <div class="embody embody_b" id="libkeyparent"  style="display:none">
            <span class="embody_t">更多资料请参考：</span>
            <div class="embody_c" id="libkey"></div>
    </div>


     <dt><span>猜你在找</span></dt>    


   


    <div id="adCollege" style="width: 42%;float: left;"> 
        <script src="http://csdnimg.cn/jobreco/job_reco.js" type="text/javascript"></script> 
        <script type="text/javascript">
            csdn.position.showEdu({
                sourceType: "blog",
                searchType: "detail",
                searchKey: "19172947",
                username: "",
                recordcount: "5",
                containerId: "adCollege" //容器DIV的id。 
            });
        </script> 
    </div>  

    
     <div id="res"  data-mod="popu_36"  class="tracking-ad" style="width: 42%;float: left;margin-right: 30px;"></div>
   
</dl>


<script type="text/javascript">
    $(function () {
        setTimeout(function () {
            var searchtitletags = 'IOS绘图详解' + ',' + $("#tags").html();
            searchService({
                index: 'blog',
                query: searchtitletags,
                from: 5,
                size: 5,
                appendTo: '#res',
                url: 'recommend',
                his: 2,
                client: "blog_cf_enhance",
                tmpl: '<dd style="background:url(http://static.blog.csdn.net/skin/default/images/blog-dot-red3.gif) no-repeat 0 10px;"><a href="#{ url }" title="#{ title }" strategy="#{ strategy }">#{ title }</a></dd>'
            });
        }, 500);
    });    

 </script>  


    <div id="ad_cen">        
                      <ins data-revive-zoneid="199" data-revive-id="8c38e720de1c90a6f6ff52f3f89c4d57"></ins>
    </div>  

    <!-- 广告位开始 -->
    <ins data-revive-zoneid="72" data-revive-id="8c38e720de1c90a6f6ff52f3f89c4d57"></ins>
    <!-- 广告位结束 -->

<div class="comment_class">
    <div id="comment_title" class="panel_head">
        <span class="see_comment">查看评论</span><a name="comments"></a></div>
    <div id="comment_list">
    </div>
    <div id="comment_bar">
    </div>
    <div id="comment_form">
    </div>
    <div class="announce">
        * 以上用户言论只代表其个人观点，不代表CSDN网站的观点或立场<a name="reply"></a><a name="quote"></a></div>
</div>

<script type="text/javascript">
    var fileName = '19172947';
    var commentscount = 0;
    var islock = false
</script>
<script type="text/javascript" src="http://static.blog.csdn.net/scripts/comment.js"></script>
    <div id="ad_bot">
    </div>
<div id="report_dialog">
</div>

<div id="d-top"  style="bottom:60px;">

        <a id="quick-reply" class="btn btn-top q-reply" title="快速回复" style="display:none;">
            <img src="http://static.blog.csdn.net/images/blog-icon-reply.png" alt="快速回复">
        </a>    
    <a id="d-top-a" class="btn btn-top backtop"  style="display: none;" title="返回顶部" onclick="_gaq.push(['_trackEvent','function', 'onclick', 'blog_articles_huidaodingbu'])" style="">         
         <img src="http://static.blog.csdn.net/images/top.png" alt="TOP">
    </a>
</div>
<script type="text/javascript">
    $(function ()
    {
        $("#ad_frm_0").height("90px");
        
        setTimeout(function(){
            $("#ad_frm_2").height("200px");
        },1000);    
    });
  
</script>
<style type="text/css">
    .tag_list
    {
        background: none repeat scroll 0 0 #FFFFFF;
        border: 1px solid #D7CBC1;
        color: #000000;
        font-size: 12px;
        line-height: 20px;
        list-style: none outside none;
        margin: 10px 2% 0 1%;
        padding: 1px;
    }
    .tag_list h5
    {
        background: none repeat scroll 0 0 #E0DBD3;
        color: #47381C;
        font-size: 12px;
        height: 24px;
        line-height: 24px;
        padding: 0 5px;
        margin: 0;
    }
    .tag_list h5 a
    {
        color: #47381C;
    }
    .classify
    {
        margin: 10px 0;
        padding: 4px 12px 8px;
    }
    .classify a
    {
        margin-right: 20px;
        white-space: nowrap;
    }
</style>


<div class="tag_list" style="display:none"></div>
  <script  language="javascript" type='text/javascript'>     
      $(function(){
              setTimeout(function(){
                  $.get("/u012858744/svc/GetTagContent",function(data){
                      $(".tag_list").html(data).show();
                  });     
              });
          },500);                       
 </script> 


<div id="pop_win" style="display:none ;position: absolute; z-index: 10000; border: 1px solid rgb(220, 220, 220); top: 222.5px; left: 630px; opacity: 1; background: none 0px 0px repeat scroll rgb(255, 255, 255);">
    
</div>
<div id="popup_mask"></div>
<style>
    #popup_mask
    {
        position: absolute;
        width: 100%;
        height: 100%;
        background: #000;
        z-index: 9999;
        left: 0px;
        top: 0px;
        opacity: 0.3;
        filter: alpha(opacity=30);
        display: none;
    }

</style>




<script type="text/javascript">
    $(function(){
        setTimeout(function(){
            $(".comment_body:contains('回复')").each(function(index,item){
                var u=$(this).text().split('：')[0].toString().replace("回复","")
                var thisComment=$(this);
                if(u)
                {
                    $.getJSON("https://passport.csdn.net/get/nick?callback=?", {users: u}, function(a) {
                        if(a!=null&&a.data!=null&&a.data.length>0)
                        {
                            nick=a.data[0].n; 
                            if(u!=nick)
                            {
                                thisComment.text(thisComment.text().replace(u,nick));  
                            }
                        }       
                    });  
                }
            });         

        },200);  

        setTimeout(function(){
            $(".math").each(function(index,value){$(this).find("span").last().css("color","#fff"); })
        },5000);

        setTimeout(function(){
            $(".math").each(function(index,value){$(this).find("span").last().css("color","#fff"); })
        },10000);

        setTimeout(function(){
            $(".math").each(function(index,value){$(this).find("span").last().css("color","#fff"); })
        },15000);
        
        setTimeout(function(){
            $("a img[src='http://js.tongji.linezing.com/stats.gif']").parent().css({"position":"absolute","left":"50%"});
        },300);
    });

    function loginbox(){
        var $logpop=$("#pop_win");
        $logpop.html('<iframe src="https://passport.csdn.net/account/loginbox?service=http://static.blog.csdn.net/callback.htm" frameborder="0" height="600" width="400" scrolling="no"></iframe>');

        $('#popup_mask').css({
            opacity: 0.5,
            width: $( document ).width() + 'px',
            height:  $( document ).height() + 'px'
        });
        $('#popup_mask').css("display","block");
 
        $logpop.css( {
            top: ($( window ).height() - $logpop.height())/ 2  + $( window 
       ).scrollTop() + 'px',
            left:($( window ).width() - $logpop.width())/ 2
        } );
 
        setTimeout( function () {
            $logpop.show();
            $logpop.css( {
                opacity: 1
            } );
        }, 200 );
 
        $('#popup_mask').unbind("click");
        $('#popup_mask').bind("click", function(){
            $('#popup_mask').hide();
            var $clopop = $("#pop_win");
            $("#common_ask_div_sc").css("display","none");
            $clopop.css( {
                opacity: 0
            } );
            setTimeout( function () {
                $clopop.hide();
            }, 350 );
            return false;
        });
    }   

</script>
 <script language="javascript" type="text/javascript" src="http://ads.csdn.net/js/async_new.js"></script>      




                        <div class="clear">
                        </div>
                    </div>                   
                
            </div>
                   
           <div id="side">
               
    <div class="side">
<div id="panel_Profile" class="panel">
<ul class="panel_head"><span>个人资料</span></ul>
<ul class="panel_body profile">
<div id="blog_userface">
    <a href="http://my.csdn.net/u012858744" target="_blank">
    <img src="http://avatar.csdn.net/0/0/6/1_u012858744.jpg" title="访问我的空间" style="max-width:90%"/>
    </a>
    <br />
    <span><a href="http://my.csdn.net/u012858744" class="user_name" target="_blank">u012858744</a></span>
</div>
<div class="interact">

    <a href="javascript:void(0);" class="attent" id="span_add_follow" title="[加关注]"></a>

 <a href="javascript:void(0);" class="letter"  title="[发私信]" onclick="window.open('http://msg.csdn.net/letters/model?receiver=u012858744','_blank','height=350,width=700');_gaq.push(['_trackEvent','function', 'onclick', 'blog_articles_sixin'])"></a>  
</div>
<div id="blog_medal">
                <div id="bms_box">
               </div>
</div>
<ul id="blog_rank">
    <li>访问：<span>57793次</span></li>
    <li>积分：<span>962</span> </li>    
    <li >等级： <span style="position:relative;display:inline-block;z-index:1" >
            <img src="http://c.csdnimg.cn/jifen/images/xunzhang/jianzhang/blog3.png" alt="" style="vertical-align: middle;" id="leveImg">
            <div id="smallTittle" style=" position: absolute;  left: -24px;  top: 25px;  text-align: center;  width: 101px;  height: 32px;  background-color: #fff;  line-height: 32px;  border: 2px #DDDDDD solid;  box-shadow: 0px 2px 2px rgba (0,0,0,0.1);  display: none;   z-index: 999;">
            <div style="left: 42%;  top: -8px;  position: absolute;  width: 0;  height: 0;  border-left: 10px solid transparent;  border-right: 10px solid transparent;  border-bottom: 8px solid #EAEAEA;"></div>
            积分：962 </div>
        </span>  </li>
    <li>排名：<span>千里之外</span></li>
</ul>
<ul id="blog_statistics">
    <li>原创：<span>29篇</span></li>
    <li>转载：<span>42篇</span></li>
    <li>译文：<span>4篇</span></li>
    <li>评论：<span>4条</span></li>
</ul>
</ul>
</div>


<div class="panel" id="panel_Search">
    <ul class="panel_head"><span>文章搜索</span></ul>
    <ul class="panel_body">
        <form id="frmSearch" action="http://so.csdn.net/search" class="form_search" target="_blank">
        <span><input id="inputSearch" type="text" class="blogsearch" title="请输入关键字" /></span>
        <input id="btnSubmit" type="button" value="搜索" title="search in blog" />
        <input type="hidden" name="q" id="inputQ" />
        <input type="hidden" name="t" value="blog" />
        <a id="btnSearchBlog" target="_blank"></a>
        </form>
    </ul>
</div>

<script type="text/javascript">
    $(function () {
        $("#btnSubmit").click(function () {           
            search();
        });

        $("#frmSearch").submit(function () {
            search();
            return false;
        });

        function search()
        {
            var url = "http://so.csdn.net/so/search/s.do?q=" + encodeURIComponent($("#inputSearch").val()) + "&u=" + username + "&t=blog";
            window.location.href = url;
        }   
    });
</script><div id="panel_Category" class="panel">
<ul class="panel_head"><span>文章分类</span></ul>
<ul class="panel_body">    
                 <li>
                    <a href="/u012858744/article/category/1775785" onclick="_gaq.push(['_trackEvent','function', 'onclick', 'blog_articles_wenzhangfenlei']); ">Objective-C</a><span>(25)</span>
                </li>
                 <li>
                    <a href="/u012858744/article/category/1790805" onclick="_gaq.push(['_trackEvent','function', 'onclick', 'blog_articles_wenzhangfenlei']); ">IOS开发</a><span>(62)</span>
                </li>
                 <li>
                    <a href="/u012858744/article/category/1805939" onclick="_gaq.push(['_trackEvent','function', 'onclick', 'blog_articles_wenzhangfenlei']); ">学习|思考</a><span>(5)</span>
                </li>
</ul>
</div><div id="panel_Archive" class="panel">
<ul class="panel_head"><span>文章存档</span></ul>
<ul class="panel_body">
<div id="archive_list">
<!--归档统计-->
<li><a href="/u012858744/article/month/2014/05">2014年05月</a><span>(3)</span></li><li><a href="/u012858744/article/month/2014/04">2014年04月</a><span>(1)</span></li><li><a href="/u012858744/article/month/2014/03">2014年03月</a><span>(2)</span></li><li><a href="/u012858744/article/month/2014/02">2014年02月</a><span>(3)</span></li><li><a href="/u012858744/article/month/2014/01">2014年01月</a><span>(30)</span></li><li><a href="/u012858744/article/month/2013/12">2013年12月</a><span>(32)</span></li><li><a href="/u012858744/article/month/2013/11">2013年11月</a><span>(4)</span></li>
</div>
</ul>
</div>
<div id="hotarticls" class="panel">
<ul class="panel_head">
    <span>       
阅读排行    </span>
</ul>

<ul class="panel_body itemlist">
<li>
<a href="/houwenfu/article/details/17650479" title="IOS开发之常用的正则表达式">IOS开发之常用的正则表达式</a><span>(7744)</span>
</li>
<li>
<a href="/houwenfu/article/details/18239631" title="IOS中过滤HTML标签">IOS中过滤HTML标签</a><span>(1446)</span>
</li>
<li>
<a href="/houwenfu/article/details/17735813" title="IOS开发之UIScrollViewDelegate详解">IOS开发之UIScrollViewDelegate详解</a><span>(1421)</span>
</li>
<li>
<a href="/houwenfu/article/details/17337885" title="IOS开发之UINavigationController详解">IOS开发之UINavigationController详解</a><span>(1269)</span>
</li>
<li>
<a href="/houwenfu/article/details/17893117" title="了解产品设计中的BRD、MRD、PRD、FSD需求文档">了解产品设计中的BRD、MRD、PRD、FSD需求文档</a><span>(1246)</span>
</li>
<li>
<a href="/houwenfu/article/details/17650851" title="IOS开发相关网站大集合分享">IOS开发相关网站大集合分享</a><span>(1077)</span>
</li>
<li>
<a href="/houwenfu/article/details/20711261" title="IOS中如何判断当前网络状态">IOS中如何判断当前网络状态</a><span>(1025)</span>
</li>
<li>
<a href="/houwenfu/article/details/19172947" title="IOS绘图详解">IOS绘图详解</a><span>(1004)</span>
</li>
<li>
<a href="/houwenfu/article/details/17764883" title="iOS6新特征：UIRefreshControl[下拉刷新]使用示例">iOS6新特征：UIRefreshControl[下拉刷新]使用示例</a><span>(997)</span>
</li>
<li>
<a href="/houwenfu/article/details/17200985" title="iOS UITableView 实现上拉及下拉刷新">iOS UITableView 实现上拉及下拉刷新</a><span>(991)</span>
</li>
</ul>
</div>
<div id="hotarticls2" class="panel">
<ul class="panel_head"><span>评论排行</span></ul>
<ul class="panel_body itemlist">
<li>
<a href="/houwenfu/article/details/17735869" title="UIApplicationDelegate-委托方法浅析">UIApplicationDelegate-委托方法浅析</a><span>(1)</span>
</li>
<li>
<a href="/houwenfu/article/details/17764883" title="iOS6新特征：UIRefreshControl[下拉刷新]使用示例">iOS6新特征：UIRefreshControl[下拉刷新]使用示例</a><span>(1)</span>
</li>
<li>
<a href="/houwenfu/article/details/17788567" title="深度围观block：第一集">深度围观block：第一集</a><span>(1)</span>
</li>
<li>
<a href="/houwenfu/article/details/18033699" title="在IPhone桌面的应用程序图标右上角显示数字">在IPhone桌面的应用程序图标右上角显示数字</a><span>(1)</span>
</li>
<li>
<a href="/houwenfu/article/details/17232975" title="iOS 开发之Target-Action">iOS 开发之Target-Action</a><span>(0)</span>
</li>
<li>
<a href="/houwenfu/article/details/26668939" title="NSProgress">NSProgress</a><span>(0)</span>
</li>
<li>
<a href="/houwenfu/article/details/17200985" title="iOS UITableView 实现上拉及下拉刷新">iOS UITableView 实现上拉及下拉刷新</a><span>(0)</span>
</li>
<li>
<a href="/houwenfu/article/details/17187263" title="一个iOS 框架介绍：MKNetworkKit">一个iOS 框架介绍：MKNetworkKit</a><span>(0)</span>
</li>
<li>
<a href="/houwenfu/article/details/17161739" title="UIScrollView中的UITextField键盘遮挡问题的最简单解决办法">UIScrollView中的UITextField键盘遮挡问题的最简单解决办法</a><span>(0)</span>
</li>
<li>
<a href="/houwenfu/article/details/17003597" title="开源中国iOS客户端学习——(七)MBProgressHUD特效">开源中国iOS客户端学习——(七)MBProgressHUD特效</a><span>(0)</span>
</li>
</ul>
</div>
<div id="homepageArticles" class="panel tracking-ad" data-mod="popu_4">
<ul class="panel_head"><span>推荐文章</span></ul>
<ul class="panel_body" id="ad_commend">
<ul>
<li><a href="http://blog.csdn.net/lmj623565791/article/details/53370414" target="_blank">* Android 反编译初探 应用是如何被注入广告的</a></li>
<li><a href="http://blog.csdn.net/foruok/article/details/53500801" 
target="_blank">* 凭兴趣求职80%会失败，为什么</a></li>
<li><a href="http://blog.csdn.net/AndroidMsky/article/details/53490459" 
target="_blank">* 安卓微信自动抢红包插件优化和实现</a></li>
<li><a href="http://blog.csdn.net/poem_qianmo/article/details/53240330" target="_blank">* 【游戏设计模式】之四 《游戏编程模式》全书内容提炼总结</a></li>
<li><a href="http://blog.csdn.net/jiangwei0910410003/article/details/53404018" 
target="_blank">* 带你开发一款给Apk中自动注入代码工具icodetools(完善篇)</a></li>


</ul></ul>
</div>


<div id="newcomments" class="panel">
<ul class="panel_head"><span>最新评论</span></ul>
<ul class="panel_body itemlist">
    <li>
   
         <a href="/houwenfu/article/details/17788567#comments">深度围观block：第一集</a>
    <p style="margin:0px;"><a href="/ganjicijiao" class="user_name">ganjicijiao</a>:
感激赐教,谢谢楼主分享!
    </p>
    </li>
    <li>
   
         <a href="/houwenfu/article/details/18033699#comments">在IPhone桌面的应用程序图标右上角显示数字</a>
    <p style="margin:0px;"><a href="/u013082522" class="user_name">u013082522</a>:
dingyixia
    </p>
    </li>
    <li>
   
         <a href="/houwenfu/article/details/17764883#comments">iOS6新特征：UIRefreshControl[下拉刷新]使用示例</a>
    <p style="margin:0px;"><a href="/u013082522" class="user_name">u013082522</a>:
掉渣天~~
    </p>
    </li>
    <li>
   
         <a href="/houwenfu/article/details/17735869#comments">UIApplicationDelegate-委托方法浅析</a>
    <p style="margin:0px;"><a href="/guorenqing521521" class="user_name">guorenqing521521</a>:
一般，当程序调到后台时，我们使用applicationDidEnterBackground方法，来进...
    </p>
    </li>
</ul>
</div>
    </div>
    <div class="clear">
    </div>


                   <!-- 广告位开始 --> 
                    <ins data-revive-zoneid="190" data-revive-id="8c38e720de1c90a6f6ff52f3f89c4d57"></ins> 
                    <!-- 广告位结束 -->

           </div>   

            <div class="clear">
            </div>
        </div>

        

<script type="text/javascript" src="http://c.csdnimg.cn/rabbit/cnick/cnick.js"></script>
<script type="text/javascript" src="http://static.blog.csdn.net/scripts/newblog.min.js"></script>


<script type="text/javascript" src="http://medal.blog.csdn.net/showblogmedal.ashx?blogid=2083285"></script>
<script type="text/javascript" src="http://static.blog.csdn.net/scripts/JavaScript1.js"></script>

    <script type="text/javascript" src="http://passport.csdn.net/content/loginbox/login.js"></script>
<script type="text/javascript">document.write("<img src=http://counter.csdn.net/pv.aspx?id=24 border=0 width=0 height=0>");</script>
<script type="text/javascript" src="http://www.csdn.net/ui/scripts/Csdn/counter.js"></script>
<script type="text/javascript" src="http://ad.csdn.net/scripts/ad-blog.js"></script>
<script type="text/javascript">
    $(function () {
        function __get_code_toolbar(snippet_id) {
            return $("<span class='tracking-ad' data-mod='popu_167'><a href='https://code.csdn.net/snippets/"
                    + snippet_id
                    + "' target='_blank' title='在CODE上查看代码片'  style='text-indent:0;'><img src='https://code.csdn.net/assets/CODE_ico.png' width=12 height=12 alt='在CODE上查看代码片' style='position:relative;top:1px;left:2px;'/></a></span>"
                    + "<span class='tracking-ad' data-mod='popu_170'><a href='https://code.csdn.net/snippets/"
                    + snippet_id
                    + "/fork' target='_blank' title='派生到我的代码片' style='text-indent:0;'><img src='https://code.csdn.net/assets/ico_fork.svg' width=12 height=12 alt='派生到我的代码片' style='position:relative;top:2px;left:2px;'/></a></span>");
        }
        
        $("[code_snippet_id]").each(function () {
            __s_id = $(this).attr("code_snippet_id");
            if (__s_id != null && __s_id != "" && __s_id != 0 && parseInt(__s_id) > 70020) {
                __code_tool = __get_code_toolbar(__s_id);
                $(this).prev().find(".tools").append(__code_tool);
            }
        });

        $(".bar").show();
    });
</script>





    </div>
      <!--new top-->
    
    <script id="csdn-toolbar-id" btnId="header_notice_num" wrapId="note1" count="5" subCount="5" type="text/javascript" src="http://c.csdnimg.cn/public/common/toolbar/js/toolbar.js"></script>     <!--new top-->
   
    <link href="http://c.csdnimg.cn/comm_ask/css/ask_float_block.css" type="text/css" rel="stylesheet" />
    <script language='JavaScript' type='text/javascript' src='http://c.csdnimg.cn/comm_ask/js/libs/wmd.js'></script>
    <script language='JavaScript' type='text/javascript' src='http://c.csdnimg.cn/comm_ask/js/libs/showdown.js'></script>
    <script language='JavaScript' type='text/javascript' src='http://c.csdnimg.cn/comm_ask/js/libs/prettify.js'></script>
    <script language='JavaScript' type='text/javascript' src='http://c.csdnimg.cn/comm_ask/js/apps/ask_float_block.js'></script>
   

   

  <div id="a52b5334d" style="width: 1px; height: 1px; display: none;">
                    <script id="adJs52b5334"></script>
                    <script>document.getElementById("adJs52b5334").src = "http://ads.csdn.net/js/opt/52b5334.js?t=" + Math.random();</script>
   </div>

    <link rel="stylesheet" href="http://static.blog.csdn.net/css/blog_code.css" />
    <script type="text/javascript" src="http://static.blog.csdn.net/scripts/saveToCode.js"></script>
      <script type="text/javascript" src="//csdnimg.cn/rabbit/tracking-ad/main.js?75eacd8"></script>

     <link rel="stylesheet" href="http://static.blog.csdn.net/css/fa.css" />

    <div class="pop_CA_cover"  style="display:none"></div>
    <div class="pop pop_CA"  style="display:none">
          <div class="CA_header">
            收藏助手
            <span class="cancel_icon"  id="fapancle"  onclick="$('.pop_CA').hide();$('.pop_CA_cover').hide();"></span>
          </div>
          <iframe src="" id="fa" frameborder="0" width="100%" height="360"  scrolling="no" />
    </div>
</body>
</html>   
 